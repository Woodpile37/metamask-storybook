(globalThis.webpackChunkmetamask_crx=globalThis.webpackChunkmetamask_crx||[]).push([[9105],{"./ui/components/ui/loading-heartbeat/loading-heartbeat.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DefaultStory:()=>DefaultStory,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _DefaultStory$paramet,_DefaultStory$paramet2,_DefaultStory$paramet3,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),___WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ui/components/ui/loading-heartbeat/index.js");const __WEBPACK_DEFAULT_EXPORT__={title:"Components/UI/LoadingHeartBeat",component:___WEBPACK_IMPORTED_MODULE_1__.Z,argTypes:{backgroundColor:{control:"text"},estimateUsed:{control:"text"}},args:{backgroundColor:"var(--color-background-default)",estimateUsed:"low"}},DefaultStory=args=>react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(___WEBPACK_IMPORTED_MODULE_1__.Z,args),"Text underneath LoadingHeartBeat");DefaultStory.storyName="Default",DefaultStory.parameters={...DefaultStory.parameters,docs:{...null===(_DefaultStory$paramet=DefaultStory.parameters)||void 0===_DefaultStory$paramet?void 0:_DefaultStory$paramet.docs,source:{originalSource:"args => <div>\n    <LoadingHeartBeat {...args} />\n    Text underneath LoadingHeartBeat\n  </div>",...null===(_DefaultStory$paramet2=DefaultStory.parameters)||void 0===_DefaultStory$paramet2||null===(_DefaultStory$paramet3=_DefaultStory$paramet2.docs)||void 0===_DefaultStory$paramet3?void 0:_DefaultStory$paramet3.source}}};const __namedExportsOrder=["DefaultStory"];DefaultStory.__docgenInfo={description:"",methods:[],displayName:"DefaultStory"}},"./ui/components/ui/loading-heartbeat/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>LoadingHeartBeat});var es=__webpack_require__("./node_modules/react-redux/es/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react=__webpack_require__("./node_modules/react/index.js"),gas=__webpack_require__("./ui/helpers/utils/gas.js"),app=__webpack_require__("./ui/ducks/app/app.ts"),lodash=__webpack_require__("./node_modules/lodash/lodash.js"),useGasFeeEstimates=__webpack_require__("./ui/hooks/useGasFeeEstimates.js");var process=__webpack_require__("./node_modules/process/browser.js");const LOADING_CLASS="loading-heartbeat--active";function LoadingHeartBeat({estimateUsed,backgroundColor="var(--color-background-default)"}){!function useShouldAnimateGasEstimations(){const{isGasEstimatesLoading,gasFeeEstimates}=(0,useGasFeeEstimates.a)(),dispatch=(0,es.I0)(),isGasLoadingAnimationActive=(0,es.v9)(app.Jl),lastGasEstimates=(0,react.useRef)(gasFeeEstimates),gasEstimatesChanged=!(0,lodash.isEqual)(lastGasEstimates.current,gasFeeEstimates),gasJustLoaded=(0,lodash.isEqual)(lastGasEstimates.current,{});gasEstimatesChanged&&(lastGasEstimates.current=gasFeeEstimates);const showLoadingAnimation=isGasEstimatesLoading||gasEstimatesChanged&&!gasJustLoaded;(0,react.useEffect)((()=>{!1===isGasLoadingAnimationActive&&!0===showLoadingAnimation&&dispatch((0,app.nh)(!0))}),[dispatch,isGasLoadingAnimationActive,showLoadingAnimation]),(0,react.useEffect)((()=>{let timer;return isGasLoadingAnimationActive&&!showLoadingAnimation&&(timer=setTimeout((()=>{dispatch((0,app.nh)(!1))}),2e3)),()=>{timer&&clearTimeout(timer)}}),[dispatch,isGasLoadingAnimationActive,showLoadingAnimation])}();const active=(0,es.v9)(app.Jl);return process.env.IN_TEST||estimateUsed&&!(0,gas.DW)(estimateUsed)?null:react.createElement("div",{className:classnames_default()("loading-heartbeat",{[LOADING_CLASS]:active}),onClick:e=>{e.preventDefault(),e.stopPropagation()},style:{backgroundColor}})}LoadingHeartBeat.propTypes={backgroundColor:prop_types_default().string,estimateUsed:prop_types_default().string},LoadingHeartBeat.__docgenInfo={description:"",methods:[],displayName:"LoadingHeartBeat",props:{backgroundColor:{defaultValue:{value:"'var(--color-background-default)'",computed:!1},description:"",type:{name:"string"},required:!1},estimateUsed:{description:"",type:{name:"string"},required:!1}}}},"./ui/helpers/utils/gas.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{DW:()=>isMetamaskSuggestedGasEstimate,Ll:()=>gasEstimateGreaterThanGasUsedPlusTenPercent,VS:()=>editGasModeIsSpeedUpOrCancel,Vc:()=>addTenPercentAndRound,m5:()=>formatGasFeeOrFeeRange});var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/lodash.js"),bignumber_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/bignumber.js/bignumber.js"),bignumber_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(bignumber_js__WEBPACK_IMPORTED_MODULE_1__),_shared_constants_gas__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./shared/constants/gas.ts"),_shared_modules_conversion_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./shared/modules/conversion.utils.ts"),_shared_modules_Numeric__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./shared/modules/Numeric.ts"),_util__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ui/helpers/utils/util.js");const TEN_PERCENT_NUMERIC=new _shared_modules_Numeric__WEBPACK_IMPORTED_MODULE_4__.D(1.1,10),gasEstimateGreaterThanGasUsedPlusTenPercent=(gasUsed,gasFeeEstimates,estimate)=>{var _gasFeeEstimates$esti;let{maxFeePerGas:maxFeePerGasInTransaction}=gasUsed;maxFeePerGasInTransaction=new(bignumber_js__WEBPACK_IMPORTED_MODULE_1___default())((0,_shared_modules_conversion_utils__WEBPACK_IMPORTED_MODULE_3__.Yg)(addTenPercentAndRound(maxFeePerGasInTransaction)));const maxFeePerGasFromEstimate=null===(_gasFeeEstimates$esti=gasFeeEstimates[estimate])||void 0===_gasFeeEstimates$esti?void 0:_gasFeeEstimates$esti.suggestedMaxFeePerGas;return(0,_util__WEBPACK_IMPORTED_MODULE_5__.Xn)(maxFeePerGasFromEstimate,maxFeePerGasInTransaction)};function addTenPercentAndRound(hexStringValue){if(void 0!==hexStringValue)return new _shared_modules_Numeric__WEBPACK_IMPORTED_MODULE_4__.D(hexStringValue,16).times(TEN_PERCENT_NUMERIC).round(0).toPrefixedHexString()}function isMetamaskSuggestedGasEstimate(estimate){return[_shared_constants_gas__WEBPACK_IMPORTED_MODULE_2__.RQ.high,_shared_constants_gas__WEBPACK_IMPORTED_MODULE_2__.RQ.medium,_shared_constants_gas__WEBPACK_IMPORTED_MODULE_2__.RQ.low].includes(estimate)}function formatGasFeeOrFeeRange(feeOrFeeRange,{precision:precisionOrPrecisions=2}={}){if((0,_util__WEBPACK_IMPORTED_MODULE_5__.Rw)(feeOrFeeRange)||Array.isArray(feeOrFeeRange)&&0===feeOrFeeRange.length)return null;const range=Array.isArray(feeOrFeeRange)?feeOrFeeRange.slice(0,2):[feeOrFeeRange],precisions=Array.isArray(precisionOrPrecisions)?precisionOrPrecisions.slice(0,2):(0,lodash__WEBPACK_IMPORTED_MODULE_0__.times)(range.length,(0,lodash__WEBPACK_IMPORTED_MODULE_0__.constant)(precisionOrPrecisions));return`${(0,lodash__WEBPACK_IMPORTED_MODULE_0__.uniq)((0,lodash__WEBPACK_IMPORTED_MODULE_0__.zip)(range,precisions).map((([fee,precision])=>void 0===precision?fee:(0,_util__WEBPACK_IMPORTED_MODULE_5__.YQ)(fee,precision)))).join(" - ")} GWEI`}function editGasModeIsSpeedUpOrCancel(editGasMode){return editGasMode===_shared_constants_gas__WEBPACK_IMPORTED_MODULE_2__.G_.cancel||editGasMode===_shared_constants_gas__WEBPACK_IMPORTED_MODULE_2__.G_.speedUp}},"./ui/hooks/useGasFeeEstimates.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{a:()=>useGasFeeEstimates});var isEqual=__webpack_require__("./node_modules/lodash/isEqual.js"),isEqual_default=__webpack_require__.n(isEqual),es=__webpack_require__("./node_modules/react-redux/es/index.js"),metamask=__webpack_require__("./ui/ducks/metamask/metamask.js"),react=__webpack_require__("./node_modules/react/index.js"),actions=__webpack_require__("./ui/store/actions.ts");function useGasFeeEstimates(){const gasEstimateType=(0,es.v9)(metamask.xP),gasFeeEstimates=(0,es.v9)(metamask.lq,isEqual_default()),isGasEstimatesLoading=(0,es.v9)(metamask.rc),isNetworkBusy=(0,es.v9)(metamask.tg);return function useSafeGasEstimatePolling(){(0,react.useEffect)((()=>{let pollToken,active=!0;const cleanup=()=>{active=!1,pollToken&&((0,actions.T_6)(pollToken),(0,actions.hUm)(pollToken))};return(0,actions.mhS)().then((newPollToken=>{active?(pollToken=newPollToken,(0,actions.lTb)(pollToken)):((0,actions.T_6)(newPollToken),(0,actions.hUm)(pollToken))})),window.addEventListener("beforeunload",cleanup),()=>{cleanup(),window.removeEventListener("beforeunload",cleanup)}}),[])}(),{gasFeeEstimates,gasEstimateType,isGasEstimatesLoading,isNetworkBusy}}},"./node_modules/lodash/isEqual.js":(module,__unused_webpack_exports,__webpack_require__)=>{var baseIsEqual=__webpack_require__("./node_modules/lodash/_baseIsEqual.js");module.exports=function isEqual(value,other){return baseIsEqual(value,other)}}}]);