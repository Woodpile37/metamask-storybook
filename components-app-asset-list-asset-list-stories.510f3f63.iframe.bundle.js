"use strict";(globalThis.webpackChunkmetamask_crx=globalThis.webpackChunkmetamask_crx||[]).push([[574],{"./ui/components/app/asset-list/asset-list.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DefaultStory:()=>DefaultStory,__namedExportsOrder:()=>__namedExportsOrder,default:()=>asset_list_stories});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),es=__webpack_require__("./node_modules/react-redux/es/index.js"),lodash=__webpack_require__("./node_modules/lodash/lodash.js"),selectors=__webpack_require__("./ui/selectors/index.js"),useTokenFiatAmount=__webpack_require__("./ui/hooks/useTokenFiatAmount.js"),multichain=__webpack_require__("./ui/components/multichain/index.js");function TokenCell({address,image,symbol,string,onClick}){const tokenList=(0,es.v9)(selectors.HJ),tokenData=Object.values(tokenList).find((token=>token.symbol===symbol)),title=(null==tokenData?void 0:tokenData.name)||symbol,tokenImage=(null==tokenData?void 0:tokenData.iconUrl)||image,formattedFiat=(0,useTokenFiatAmount.Q)(address,string,symbol);return react.createElement(multichain.wS,{onClick:()=>onClick(address),tokenSymbol:symbol,tokenImage,primary:`${string||0}`,secondary:formattedFiat,title})}TokenCell.propTypes={address:prop_types_default().string,symbol:prop_types_default().string,string:prop_types_default().string,onClick:prop_types_default().func.isRequired,image:prop_types_default().string},TokenCell.__docgenInfo={description:"",methods:[],displayName:"TokenCell",props:{address:{description:"",type:{name:"string"},required:!1},symbol:{description:"",type:{name:"string"},required:!1},string:{description:"",type:{name:"string"},required:!1},onClick:{description:"",type:{name:"func"},required:!0},image:{description:"",type:{name:"string"},required:!1}}};var useI18nContext=__webpack_require__("./ui/hooks/useI18nContext.js"),useTokenTracker=__webpack_require__("./ui/hooks/useTokenTracker.js"),metamask=__webpack_require__("./ui/ducks/metamask/metamask.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}function TokenList({onTokenClick}){const t=(0,useI18nContext.C)(),shouldHideZeroBalanceTokens=(0,es.v9)(selectors.OwG),tokens=(0,es.v9)(metamask.lz,lodash.isEqual),{loading,tokensWithBalances}=(0,useTokenTracker.S)(tokens,!0,shouldHideZeroBalanceTokens);return loading?react.createElement("div",{style:{display:"flex",height:"250px",alignItems:"center",justifyContent:"center",padding:"30px"}},t("loadingTokens")):react.createElement("div",null,tokensWithBalances.map(((tokenData,index)=>react.createElement(TokenCell,_extends({key:index},tokenData,{onClick:onTokenClick})))))}TokenList.propTypes={onTokenClick:prop_types_default().func.isRequired},TokenList.__docgenInfo={description:"",methods:[],displayName:"TokenList",props:{onTokenClick:{description:"",type:{name:"func"},required:!0}}};var common=__webpack_require__("./ui/helpers/constants/common.ts"),useUserPreferencedCurrency=__webpack_require__("./ui/hooks/useUserPreferencedCurrency.js"),useCurrencyDisplay=__webpack_require__("./ui/hooks/useCurrencyDisplay.js"),box=__webpack_require__("./ui/components/ui/box/box.js"),metametrics=__webpack_require__("./ui/contexts/metametrics.js"),constants_metametrics=__webpack_require__("./shared/constants/metametrics.ts"),actions=__webpack_require__("./ui/store/actions.ts"),transaction=__webpack_require__("./shared/constants/transaction.ts"),detected_token_selection_popover=__webpack_require__("./ui/components/app/detected-token/detected-token-selection-popover/detected-token-selection-popover.js"),detected_token_ignored_popover=__webpack_require__("./ui/components/app/detected-token/detected-token-ignored-popover/detected-token-ignored-popover.js");const sortingBasedOnTokenSelection=tokensDetected=>(0,lodash.chain)(tokensDetected).values().groupBy((token=>token.selected?"selected":"deselected")).mapValues((group=>group.map((({token})=>{const{address,symbol,decimals,aggregators}=token;return{address,symbol,decimals,aggregators}})))).value(),DetectedToken=({setShowDetectedTokens})=>{const dispatch=(0,es.I0)(),trackEvent=(0,react.useContext)(metametrics.Wd),chainId=(0,es.v9)(selectors.BVZ),detectedTokens=(0,es.v9)(selectors.Tl8),[tokensListDetected,setTokensListDetected]=(0,react.useState)((()=>detectedTokens.reduce(((tokenObj,token)=>(tokenObj[token.address]={token,selected:!0},tokenObj)),{}))),[showDetectedTokenIgnoredPopover,setShowDetectedTokenIgnoredPopover]=(0,react.useState)(!1),[partiallyIgnoreDetectedTokens,setPartiallyIgnoreDetectedTokens]=(0,react.useState)(!1),importSelectedTokens=async selectedTokens=>{selectedTokens.forEach((importedToken=>{trackEvent({event:constants_metametrics.AW.TokenAdded,category:constants_metametrics.ci.Wallet,sensitiveProperties:{token_symbol:importedToken.symbol,token_contract_address:importedToken.address,token_decimal_precision:importedToken.decimals,source_connection_method:constants_metametrics.iL.Detected,token_standard:transaction.Yn.ERC20,asset_type:transaction.h3.token,token_added_type:"detected",chain_id:chainId}})})),await dispatch((0,actions.P1j)(selectedTokens));const tokenSymbols=selectedTokens.map((({symbol})=>symbol));dispatch((0,actions.cgB)(tokenSymbols.join(", ")))};return react.createElement(react.Fragment,null,showDetectedTokenIgnoredPopover&&react.createElement(detected_token_ignored_popover.Z,{onCancelIgnore:()=>{setShowDetectedTokenIgnoredPopover(!1),setPartiallyIgnoreDetectedTokens(!1)},handleClearTokensSelection:async()=>{const{selected:selectedTokens=[],deselected:deSelectedTokens=[]}=sortingBasedOnTokenSelection(tokensListDetected);deSelectedTokens.length<detectedTokens.length&&await importSelectedTokens(selectedTokens);const tokensDetailsList=deSelectedTokens.map((({symbol,address})=>`${symbol} - ${address}`));trackEvent({event:constants_metametrics.AW.TokenHidden,category:constants_metametrics.ci.Wallet,sensitiveProperties:{tokens:tokensDetailsList,location:constants_metametrics.c7.TokenDetection,token_standard:transaction.Yn.ERC20,asset_type:transaction.h3.token}});const deSelectedTokensAddresses=deSelectedTokens.map((({address})=>address));await dispatch((0,actions.iUk)({tokensToIgnore:deSelectedTokensAddresses,dontShowLoadingIndicator:!0})),setShowDetectedTokens(!1),setPartiallyIgnoreDetectedTokens(!1)},partiallyIgnoreDetectedTokens}),detectedTokens.length>0&&react.createElement(detected_token_selection_popover.Z,{detectedTokens,tokensListDetected,handleTokenSelection:token=>{setTokensListDetected((prevState=>({...prevState,[token.address]:{...prevState[token.address],selected:!prevState[token.address].selected}})))},onImport:async()=>{const{selected:selectedTokens=[]}=sortingBasedOnTokenSelection(tokensListDetected);selectedTokens.length<detectedTokens.length?(setShowDetectedTokenIgnoredPopover(!0),setPartiallyIgnoreDetectedTokens(!0)):(await importSelectedTokens(selectedTokens),setShowDetectedTokens(!1))},onIgnoreAll:()=>{const newTokensListDetected={...tokensListDetected};for(const tokenAddress of Object.keys(tokensListDetected))newTokensListDetected[tokenAddress].selected=!1;setTokensListDetected(newTokensListDetected),setShowDetectedTokenIgnoredPopover(!0)},setShowDetectedTokens,sortingBasedOnTokenSelection}))};DetectedToken.propTypes={setShowDetectedTokens:prop_types_default().func.isRequired},DetectedToken.__docgenInfo={description:"",methods:[],displayName:"DetectedToken",props:{setShowDetectedTokens:{description:"",type:{name:"func"},required:!0}}};const detected_token=DetectedToken,AssetList=({onClickAsset})=>{const[showDetectedTokens,setShowDetectedTokens]=(0,react.useState)(!1),selectedAccountBalance=(0,es.v9)(selectors._ot),nativeCurrency=(0,es.v9)(metamask.JK),showFiat=(0,es.v9)(selectors.i8I),trackEvent=(0,react.useContext)(metametrics.Wd),balanceIsLoading=!(0,es.v9)(selectors._ot),{currency:primaryCurrency,numberOfDecimals:primaryNumberOfDecimals}=(0,useUserPreferencedCurrency.I)(common._8,{ethNumberOfDecimals:4}),{currency:secondaryCurrency,numberOfDecimals:secondaryNumberOfDecimals}=(0,useUserPreferencedCurrency.I)(common.Vb,{ethNumberOfDecimals:4}),[,primaryCurrencyProperties]=(0,useCurrencyDisplay._)(selectedAccountBalance,{numberOfDecimals:primaryNumberOfDecimals,currency:primaryCurrency}),[secondaryCurrencyDisplay,secondaryCurrencyProperties]=(0,useCurrencyDisplay._)(selectedAccountBalance,{numberOfDecimals:secondaryNumberOfDecimals,currency:secondaryCurrency}),primaryTokenImage=(0,es.v9)(selectors.XqD),detectedTokens=(0,es.v9)(selectors.Tl8)||[],isTokenDetectionInactiveOnNonMainnetSupportedNetwork=(0,es.v9)(selectors.s1L);return react.createElement(react.Fragment,null,react.createElement(multichain.wS,{onClick:()=>onClickAsset(nativeCurrency),title:nativeCurrency,primary:primaryCurrencyProperties.value??secondaryCurrencyProperties.value,tokenSymbol:primaryCurrencyProperties.suffix,secondary:showFiat?secondaryCurrencyDisplay:void 0,tokenImage:balanceIsLoading?null:primaryTokenImage}),react.createElement(TokenList,{onTokenClick:tokenAddress=>{onClickAsset(tokenAddress),trackEvent({event:constants_metametrics.AW.TokenScreenOpened,category:constants_metametrics.ci.Navigation,properties:{token_symbol:primaryCurrencyProperties.suffix,location:"Home"}})}}),detectedTokens.length>0&&!isTokenDetectionInactiveOnNonMainnetSupportedNetwork?react.createElement(multichain.g$,{actionButtonOnClick:()=>setShowDetectedTokens(!0),margin:4}):null,react.createElement(box.ZP,{marginTop:detectedTokens.length>0?0:4},react.createElement(multichain.QO,{margin:4,marginBottom:2})),showDetectedTokens&&react.createElement(detected_token,{setShowDetectedTokens}))};AssetList.propTypes={onClickAsset:prop_types_default().func.isRequired},AssetList.__docgenInfo={description:"",methods:[],displayName:"AssetList",props:{onClickAsset:{description:"",type:{name:"func"},required:!0}}};const asset_list=AssetList;var _DefaultStory$paramet,_DefaultStory$paramet2,_DefaultStory$paramet3;const asset_list_stories={title:"Components/App/AssetList",argTypes:{onClickAsset:{control:"onClickAsset"}},args:{onClickAsset:()=>console.log("onClickAsset fired")}},DefaultStory=args=>react.createElement(asset_list,args);DefaultStory.storyName="Default",DefaultStory.parameters={...DefaultStory.parameters,docs:{...null===(_DefaultStory$paramet=DefaultStory.parameters)||void 0===_DefaultStory$paramet?void 0:_DefaultStory$paramet.docs,source:{originalSource:"args => <AssetList {...args} />",...null===(_DefaultStory$paramet2=DefaultStory.parameters)||void 0===_DefaultStory$paramet2||null===(_DefaultStory$paramet3=_DefaultStory$paramet2.docs)||void 0===_DefaultStory$paramet3?void 0:_DefaultStory$paramet3.source}}};const __namedExportsOrder=["DefaultStory"];DefaultStory.__docgenInfo={description:"",methods:[],displayName:"DefaultStory"}},"./ui/components/app/detected-token/detected-token-ignored-popover/detected-token-ignored-popover.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_7__),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_hooks_useI18nContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ui/hooks/useI18nContext.js"),_ui_popover__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/components/ui/popover/index.js"),_ui_button__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ui/components/ui/button/index.js"),_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ui/helpers/constants/design-system.ts"),_component_library__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ui/components/component-library/index.js");const DetectedTokenIgnoredPopover=({partiallyIgnoreDetectedTokens,onCancelIgnore,handleClearTokensSelection})=>{const t=(0,_hooks_useI18nContext__WEBPACK_IMPORTED_MODULE_2__.C)(),footer=react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_button__WEBPACK_IMPORTED_MODULE_4__.Z,{className:"detected-token-ignored-popover__ignore-button",type:"secondary",onClick:onCancelIgnore},t("cancel")),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_button__WEBPACK_IMPORTED_MODULE_4__.Z,{className:"detected-token-ignored-popover__import-button",type:"primary",onClick:handleClearTokensSelection},t("confirm")));return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_popover__WEBPACK_IMPORTED_MODULE_3__.Z,{title:t(partiallyIgnoreDetectedTokens?"importSelectedTokens":"areYouSure"),className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("detected-token-ignored-popover",{"detected-token-ignored-popover--import":partiallyIgnoreDetectedTokens,"detected-token-ignored-popover--ignore":!partiallyIgnoreDetectedTokens}),footer},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_component_library__WEBPACK_IMPORTED_MODULE_6__.xv,{variant:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_5__.rK.bodySm,as:"h6",marginTop:0,marginRight:5,marginBottom:7,marginLeft:5},t(partiallyIgnoreDetectedTokens?"importSelectedTokensDescription":"ignoreTokenWarning")))};DetectedTokenIgnoredPopover.propTypes={partiallyIgnoreDetectedTokens:prop_types__WEBPACK_IMPORTED_MODULE_7___default().bool.isRequired,onCancelIgnore:prop_types__WEBPACK_IMPORTED_MODULE_7___default().func.isRequired,handleClearTokensSelection:prop_types__WEBPACK_IMPORTED_MODULE_7___default().func.isRequired},DetectedTokenIgnoredPopover.__docgenInfo={description:"",methods:[],displayName:"DetectedTokenIgnoredPopover",props:{partiallyIgnoreDetectedTokens:{description:"",type:{name:"bool"},required:!0},onCancelIgnore:{description:"",type:{name:"func"},required:!0},handleClearTokensSelection:{description:"",type:{name:"func"},required:!0}}};const __WEBPACK_DEFAULT_EXPORT__=DetectedTokenIgnoredPopover},"./ui/components/app/detected-token/detected-token-selection-popover/detected-token-selection-popover.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_10__),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-redux/es/index.js"),_hooks_useI18nContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ui/hooks/useI18nContext.js"),_contexts_metametrics__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/contexts/metametrics.js"),_shared_constants_metametrics__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./shared/constants/metametrics.ts"),_selectors__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ui/selectors/index.js"),_ui_popover__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ui/components/ui/popover/index.js"),_ui_box__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ui/components/ui/box/index.js"),_ui_button__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./ui/components/ui/button/index.js"),_detected_token_details_detected_token_details__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./ui/components/app/detected-token/detected-token-details/detected-token-details.js");const DetectedTokenSelectionPopover=({tokensListDetected,handleTokenSelection,onImport,onIgnoreAll,setShowDetectedTokens,sortingBasedOnTokenSelection})=>{const t=(0,_hooks_useI18nContext__WEBPACK_IMPORTED_MODULE_2__.C)(),trackEvent=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_contexts_metametrics__WEBPACK_IMPORTED_MODULE_3__.Wd),chainId=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_5__.BVZ),detectedTokens=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_5__.Tl8),{selected:selectedTokens=[]}=sortingBasedOnTokenSelection(tokensListDetected),numOfTokensImporting=selectedTokens.length===detectedTokens.length?"All":`(${selectedTokens.length})`,footer=react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_button__WEBPACK_IMPORTED_MODULE_8__.Z,{className:"detected-token-selection-popover__ignore-button",type:"secondary",onClick:()=>onIgnoreAll()},t("ignoreAll")),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_button__WEBPACK_IMPORTED_MODULE_8__.Z,{className:"detected-token-selection-popover__import-button",type:"primary",onClick:onImport,disabled:0===selectedTokens.length},t("importWithCount",[numOfTokensImporting])));return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_popover__WEBPACK_IMPORTED_MODULE_6__.Z,{className:"detected-token-selection-popover",title:1===detectedTokens.length?t("tokenFoundTitle"):t("tokensFoundTitle",[detectedTokens.length]),onClose:()=>{setShowDetectedTokens(!1);const eventTokensDetails=detectedTokens.map((({address,symbol})=>`${symbol} - ${address}`));trackEvent({event:_shared_constants_metametrics__WEBPACK_IMPORTED_MODULE_4__.AW.TokenImportCanceled,category:_shared_constants_metametrics__WEBPACK_IMPORTED_MODULE_4__.ci.Wallet,properties:{source_connection_method:_shared_constants_metametrics__WEBPACK_IMPORTED_MODULE_4__.iL.Detected,chain_id:chainId,tokens:eventTokensDetails}})},footer},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_box__WEBPACK_IMPORTED_MODULE_7__.ZP,{margin:3},detectedTokens.map(((token,index)=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(_detected_token_details_detected_token_details__WEBPACK_IMPORTED_MODULE_9__.Z,{key:index,token,handleTokenSelection,tokensListDetected})))))};DetectedTokenSelectionPopover.propTypes={tokensListDetected:prop_types__WEBPACK_IMPORTED_MODULE_10___default().object,handleTokenSelection:prop_types__WEBPACK_IMPORTED_MODULE_10___default().func.isRequired,onIgnoreAll:prop_types__WEBPACK_IMPORTED_MODULE_10___default().func.isRequired,onImport:prop_types__WEBPACK_IMPORTED_MODULE_10___default().func.isRequired,setShowDetectedTokens:prop_types__WEBPACK_IMPORTED_MODULE_10___default().func.isRequired,sortingBasedOnTokenSelection:prop_types__WEBPACK_IMPORTED_MODULE_10___default().func.isRequired},DetectedTokenSelectionPopover.__docgenInfo={description:"",methods:[],displayName:"DetectedTokenSelectionPopover",props:{tokensListDetected:{description:"",type:{name:"object"},required:!1},handleTokenSelection:{description:"",type:{name:"func"},required:!0},onIgnoreAll:{description:"",type:{name:"func"},required:!0},onImport:{description:"",type:{name:"func"},required:!0},setShowDetectedTokens:{description:"",type:{name:"func"},required:!0},sortingBasedOnTokenSelection:{description:"",type:{name:"func"},required:!0}}};const __WEBPACK_DEFAULT_EXPORT__=DetectedTokenSelectionPopover}}]);