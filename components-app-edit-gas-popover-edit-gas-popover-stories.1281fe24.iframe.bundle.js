(globalThis.webpackChunkmetamask_crx=globalThis.webpackChunkmetamask_crx||[]).push([[7347],{"./ui/components/app/edit-gas-popover/edit-gas-popover.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DefaultStory:()=>DefaultStory,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _DefaultStory$paramet,_DefaultStory$paramet2,_DefaultStory$paramet3,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-redux/es/index.js"),_store_store__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ui/store/store.ts"),_storybook_test_data__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./.storybook/test-data.js"),_shared_constants_gas__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./shared/constants/gas.ts"),_shared_modules_conversion_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./shared/modules/conversion.utils.ts"),___WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ui/components/app/edit-gas-popover/index.js");const store=(0,_store_store__WEBPACK_IMPORTED_MODULE_2__.Z)(_storybook_test_data__WEBPACK_IMPORTED_MODULE_3__.default),__WEBPACK_DEFAULT_EXPORT__={title:"Components/App/EditGasPopover",decorators:[story=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_redux__WEBPACK_IMPORTED_MODULE_1__.zt,{store},story())],argTypes:{editGasDisplayProps:{control:"object"},transaction:{control:"object"},defaultEstimateToUse:{control:"text"},mode:{control:"text"},confirmButtonText:{control:"text"},minimumGasLimit:{control:"text"},onClose:{action:"Close Edit Gas Popover"}}},transaction={userFeeLevel:_shared_constants_gas__WEBPACK_IMPORTED_MODULE_4__.RQ.medium,txParams:{maxFeePerGas:(0,_shared_modules_conversion_utils__WEBPACK_IMPORTED_MODULE_5__.Kn)("10000"),maxPriorityFeePerGas:"0x5600",gas:"0x5600",gasPrice:"0x5600"}},defaultEstimateToUse=_shared_constants_gas__WEBPACK_IMPORTED_MODULE_4__.RQ.high,mode=_shared_constants_gas__WEBPACK_IMPORTED_MODULE_4__.G_.swaps,DefaultStory=args=>react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{style:{width:"600px"}},react__WEBPACK_IMPORTED_MODULE_0__.createElement(___WEBPACK_IMPORTED_MODULE_6__.Z,args));DefaultStory.storyName="Default",DefaultStory.args={transaction,defaultEstimateToUse,mode,confirmButtonText:"Submit",minimumGasLimit:"5700"},DefaultStory.parameters={...DefaultStory.parameters,docs:{...null===(_DefaultStory$paramet=DefaultStory.parameters)||void 0===_DefaultStory$paramet?void 0:_DefaultStory$paramet.docs,source:{originalSource:"args => {\n  return <div style={{\n    width: '600px'\n  }}>\n      <EditGasPopover {...args} />\n    </div>;\n}",...null===(_DefaultStory$paramet2=DefaultStory.parameters)||void 0===_DefaultStory$paramet2||null===(_DefaultStory$paramet3=_DefaultStory$paramet2.docs)||void 0===_DefaultStory$paramet3?void 0:_DefaultStory$paramet3.source}}};const __namedExportsOrder=["DefaultStory"];DefaultStory.__docgenInfo={description:"",methods:[],displayName:"DefaultStory"}},"./ui/components/app/edit-gas-popover/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>EditGasPopover});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),es=__webpack_require__("./node_modules/react-redux/es/index.js"),useGasFeeInputs=__webpack_require__("./ui/hooks/gasFeeInput/useGasFeeInputs.js"),transaction_utils=__webpack_require__("./shared/modules/transaction.utils.js"),gas=__webpack_require__("./shared/constants/gas.ts"),popover=__webpack_require__("./ui/components/ui/popover/index.js"),ui_button=__webpack_require__("./ui/components/ui/button/index.js"),edit_gas_display=__webpack_require__("./ui/components/app/edit-gas-display/index.js"),i18n=__webpack_require__("./ui/contexts/i18n.js"),actions=__webpack_require__("./ui/store/actions.ts"),loading_heartbeat=__webpack_require__("./ui/components/ui/loading-heartbeat/index.js"),useIncrementedGasFees=__webpack_require__("./ui/hooks/useIncrementedGasFees.js"),conversion_utils=__webpack_require__("./shared/modules/conversion.utils.ts"),process=__webpack_require__("./node_modules/process/browser.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}function EditGasPopover({popoverTitle="",confirmButtonText="",editGasDisplayProps={},transaction,mode,onClose,minimumGasLimit=gas.Kw.SIMPLE}){const t=(0,react.useContext)(i18n.OO),dispatch=(0,es.I0)(),[dappSuggestedGasFeeAcknowledged,setDappSuggestedGasFeeAcknowledged]=(0,react.useState)(!1),minimumGasLimitDec=(0,conversion_utils.Z8)(minimumGasLimit),updatedCustomGasSettings=(0,useIncrementedGasFees.N)(transaction);let updatedTransaction=transaction;mode!==gas.G_.speedUp&&mode!==gas.G_.cancel||(updatedTransaction={...transaction,userFeeLevel:gas.d_,txParams:{...transaction.txParams,...updatedCustomGasSettings}});const{estimatedMinimumNative,gasPrice,setGasPrice,gasLimit,setGasLimit,properGasLimit,estimateToUse,hasGasErrors,gasErrors,onManualChange,balanceError}=(0,useGasFeeInputs.a)(gas.RQ.medium,updatedTransaction,minimumGasLimit,mode),txParamsHaveBeenCustomized=estimateToUse===gas.d_||(0,transaction_utils.EN)(updatedTransaction),closePopover=(0,react.useCallback)((()=>{onClose?onClose():dispatch((0,actions.VGc)())}),[onClose,dispatch]),onSubmit=(0,react.useCallback)((async()=>{updatedTransaction&&mode||closePopover();const newGasSettings={gas:(0,conversion_utils.X0)(gasLimit),gasLimit:(0,conversion_utils.X0)(gasLimit),estimateUsed:estimateToUse,gasPrice:(0,conversion_utils.Kn)(gasPrice)},cleanTransactionParams={...updatedTransaction.txParams},updatedTxMeta={...updatedTransaction,userEditedGasLimit:gasLimit!==Number(transaction.originalGasEstimate),userFeeLevel:estimateToUse||gas.d_,txParams:{...cleanTransactionParams,...newGasSettings}};switch(mode){case gas.G_.cancel:dispatch((0,actions.vGx)(updatedTransaction.id,newGasSettings));break;case gas.G_.speedUp:dispatch((0,actions.$eK)(updatedTransaction.id,newGasSettings));break;case gas.G_.modifyInPlace:newGasSettings.userEditedGasLimit=updatedTxMeta.userEditedGasLimit,newGasSettings.userFeeLevel=updatedTxMeta.userFeeLevel,dispatch((0,actions.Nbs)()),await dispatch((0,actions.ol_)(updatedTxMeta.id,newGasSettings)),dispatch((0,actions.awJ)())}closePopover()}),[updatedTransaction,mode,dispatch,closePopover,gasLimit,gasPrice,transaction.originalGasEstimate,estimateToUse]);let title=t("editGasTitle");popoverTitle?title=popoverTitle:mode===gas.G_.speedUp?title=t("speedUpPopoverTitle"):mode===gas.G_.cancel&&(title=t("cancelPopoverTitle"));const footerButtonText=confirmButtonText||t("save");return react.createElement(popover.Z,{title,onClose:closePopover,className:"edit-gas-popover__wrapper",footer:react.createElement(ui_button.Z,{type:"primary",onClick:onSubmit,disabled:hasGasErrors||balanceError||!txParamsHaveBeenCustomized},footerButtonText)},react.createElement("div",{style:{padding:"0 20px 20px 20px",position:"relative"}},process.env.IN_TEST?null:react.createElement(loading_heartbeat.Z,null),react.createElement(edit_gas_display.Z,_extends({dappSuggestedGasFeeAcknowledged,setDappSuggestedGasFeeAcknowledged,estimatedMinimumNative,gasPrice,setGasPrice,gasLimit,setGasLimit,properGasLimit,mode,transaction:updatedTransaction,onManualChange,minimumGasLimit:minimumGasLimitDec,balanceError,txParamsHaveBeenCustomized,gasErrors},editGasDisplayProps))))}EditGasPopover.propTypes={popoverTitle:prop_types_default().string,editGasDisplayProps:prop_types_default().object,confirmButtonText:prop_types_default().string,onClose:prop_types_default().func,transaction:prop_types_default().object,mode:prop_types_default().oneOf(Object.values(gas.G_)),minimumGasLimit:prop_types_default().string},EditGasPopover.__docgenInfo={description:"",methods:[],displayName:"EditGasPopover",props:{popoverTitle:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},confirmButtonText:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},editGasDisplayProps:{defaultValue:{value:"{}",computed:!1},description:"",type:{name:"object"},required:!1},minimumGasLimit:{defaultValue:{value:"GAS_LIMITS.SIMPLE",computed:!0},description:"",type:{name:"string"},required:!1},onClose:{description:"",type:{name:"func"},required:!1},transaction:{description:"",type:{name:"object"},required:!1},mode:{description:"",type:{name:"enum",computed:!0,value:"Object.values(EditGasModes)"},required:!1}}}},"./ui/components/ui/info-tooltip/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>_info_tooltip__WEBPACK_IMPORTED_MODULE_0__.Z});var _info_tooltip__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ui/components/ui/info-tooltip/info-tooltip.js")},"./ui/components/ui/info-tooltip/info-tooltip-icon.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>InfoTooltipIcon});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);function InfoTooltipIcon({fillColor="var(--color-icon-default)"}){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("svg",{viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{d:"M5 0C2.2 0 0 2.2 0 5s2.2 5 5 5 5-2.2 5-5-2.2-5-5-5zm0 2c.4 0 .7.3.7.7s-.3.7-.7.7-.7-.2-.7-.6.3-.8.7-.8zm.7 6H4.3V4.3h1.5V8z",fill:fillColor}))}InfoTooltipIcon.propTypes={fillColor:prop_types__WEBPACK_IMPORTED_MODULE_1___default().string},InfoTooltipIcon.__docgenInfo={description:"",methods:[],displayName:"InfoTooltipIcon",props:{fillColor:{defaultValue:{value:"'var(--color-icon-default)'",computed:!1},description:"",type:{name:"string"},required:!1}}}},"./ui/components/ui/info-tooltip/info-tooltip.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>InfoTooltip});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_4__),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_tooltip__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ui/components/ui/tooltip/index.js"),_info_tooltip_icon__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/components/ui/info-tooltip/info-tooltip-icon.js");const positionArrowClassMap={top:"info-tooltip__top-tooltip-arrow",bottom:"info-tooltip__bottom-tooltip-arrow",left:"info-tooltip__left-tooltip-arrow",right:"info-tooltip__right-tooltip-arrow"};function InfoTooltip({contentText="",position="",containerClassName,wrapperClassName,iconFillColor="var(--color-icon-alternative)"}){return react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"info-tooltip","data-testid":"info-tooltip"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_tooltip__WEBPACK_IMPORTED_MODULE_2__.Z,{interactive:!0,position,containerClassName:classnames__WEBPACK_IMPORTED_MODULE_1___default()("info-tooltip__tooltip-container",containerClassName),wrapperClassName,tooltipInnerClassName:"info-tooltip__tooltip-content",tooltipArrowClassName:positionArrowClassMap[position],html:contentText,theme:"tippy-tooltip-info"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_info_tooltip_icon__WEBPACK_IMPORTED_MODULE_3__.Z,{fillColor:iconFillColor})))}InfoTooltip.propTypes={contentText:prop_types__WEBPACK_IMPORTED_MODULE_4___default().node,position:prop_types__WEBPACK_IMPORTED_MODULE_4___default().oneOf(["top","left","bottom","right"]),containerClassName:prop_types__WEBPACK_IMPORTED_MODULE_4___default().string,wrapperClassName:prop_types__WEBPACK_IMPORTED_MODULE_4___default().string,iconFillColor:prop_types__WEBPACK_IMPORTED_MODULE_4___default().string},InfoTooltip.__docgenInfo={description:"",methods:[],displayName:"InfoTooltip",props:{contentText:{defaultValue:{value:"''",computed:!1},description:"Text label that shows up after hover",type:{name:"node"},required:!1},position:{defaultValue:{value:"''",computed:!1},description:"Shows position of the tooltip",type:{name:"enum",value:[{value:"'top'",computed:!1},{value:"'left'",computed:!1},{value:"'bottom'",computed:!1},{value:"'right'",computed:!1}]},required:!1},iconFillColor:{defaultValue:{value:"'var(--color-icon-alternative)'",computed:!1},description:"Add color for the icon",type:{name:"string"},required:!1},containerClassName:{description:"Add custom CSS class for container",type:{name:"string"},required:!1},wrapperClassName:{description:"Add custom CSS class for the wrapper",type:{name:"string"},required:!1}}}},"./ui/components/ui/loading-heartbeat/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>LoadingHeartBeat});var es=__webpack_require__("./node_modules/react-redux/es/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react=__webpack_require__("./node_modules/react/index.js"),gas=__webpack_require__("./ui/helpers/utils/gas.js"),app=__webpack_require__("./ui/ducks/app/app.ts"),lodash=__webpack_require__("./node_modules/lodash/lodash.js"),useGasFeeEstimates=__webpack_require__("./ui/hooks/useGasFeeEstimates.js");var process=__webpack_require__("./node_modules/process/browser.js");const LOADING_CLASS="loading-heartbeat--active";function LoadingHeartBeat({estimateUsed,backgroundColor="var(--color-background-default)"}){!function useShouldAnimateGasEstimations(){const{isGasEstimatesLoading,gasFeeEstimates}=(0,useGasFeeEstimates.a)(),dispatch=(0,es.I0)(),isGasLoadingAnimationActive=(0,es.v9)(app.Jl),lastGasEstimates=(0,react.useRef)(gasFeeEstimates),gasEstimatesChanged=!(0,lodash.isEqual)(lastGasEstimates.current,gasFeeEstimates),gasJustLoaded=(0,lodash.isEqual)(lastGasEstimates.current,{});gasEstimatesChanged&&(lastGasEstimates.current=gasFeeEstimates);const showLoadingAnimation=isGasEstimatesLoading||gasEstimatesChanged&&!gasJustLoaded;(0,react.useEffect)((()=>{!1===isGasLoadingAnimationActive&&!0===showLoadingAnimation&&dispatch((0,app.nh)(!0))}),[dispatch,isGasLoadingAnimationActive,showLoadingAnimation]),(0,react.useEffect)((()=>{let timer;return isGasLoadingAnimationActive&&!showLoadingAnimation&&(timer=setTimeout((()=>{dispatch((0,app.nh)(!1))}),2e3)),()=>{timer&&clearTimeout(timer)}}),[dispatch,isGasLoadingAnimationActive,showLoadingAnimation])}();const active=(0,es.v9)(app.Jl);return process.env.IN_TEST||estimateUsed&&!(0,gas.DW)(estimateUsed)?null:react.createElement("div",{className:classnames_default()("loading-heartbeat",{[LOADING_CLASS]:active}),onClick:e=>{e.preventDefault(),e.stopPropagation()},style:{backgroundColor}})}LoadingHeartBeat.propTypes={backgroundColor:prop_types_default().string,estimateUsed:prop_types_default().string},LoadingHeartBeat.__docgenInfo={description:"",methods:[],displayName:"LoadingHeartBeat",props:{backgroundColor:{defaultValue:{value:"'var(--color-background-default)'",computed:!1},description:"",type:{name:"string"},required:!1},estimateUsed:{description:"",type:{name:"string"},required:!1}}}},"./ui/hooks/useIncrementedGasFees.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{N:()=>useIncrementedGasFees});var bignumber_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/bignumber.js/bignumber.js"),bignumber_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(bignumber_js__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_shared_modules_conversion_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./shared/modules/conversion.utils.ts"),_shared_modules_transaction_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./shared/modules/transaction.utils.js"),_helpers_utils_gas__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ui/helpers/utils/gas.js"),_useGasFeeEstimates__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ui/hooks/useGasFeeEstimates.js");function getHighestIncrementedFee(originalFee,currentEstimate){const buffedOriginalHexWei=(0,_helpers_utils_gas__WEBPACK_IMPORTED_MODULE_4__.Vc)(originalFee),currentEstimateHexWei=(0,_shared_modules_conversion_utils__WEBPACK_IMPORTED_MODULE_2__.Kn)(currentEstimate);return new(bignumber_js__WEBPACK_IMPORTED_MODULE_0___default())(buffedOriginalHexWei,16).greaterThan(new(bignumber_js__WEBPACK_IMPORTED_MODULE_0___default())(currentEstimateHexWei,16))?buffedOriginalHexWei:currentEstimateHexWei}function useIncrementedGasFees(transaction){const{gasFeeEstimates={}}=(0,_useGasFeeEstimates__WEBPACK_IMPORTED_MODULE_5__.a)();return(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((()=>{var _transaction$txParams,_transaction$txParams2,_gasFeeEstimates$medi,_gasFeeEstimates$medi2;const temporaryGasSettings={gasLimit:null===(_transaction$txParams=transaction.txParams)||void 0===_transaction$txParams?void 0:_transaction$txParams.gas,gas:null===(_transaction$txParams2=transaction.txParams)||void 0===_transaction$txParams2?void 0:_transaction$txParams2.gas},suggestedMaxFeePerGas=(null==gasFeeEstimates||null===(_gasFeeEstimates$medi=gasFeeEstimates.medium)||void 0===_gasFeeEstimates$medi?void 0:_gasFeeEstimates$medi.suggestedMaxFeePerGas)??"0",suggestedMaxPriorityFeePerGas=(null==gasFeeEstimates||null===(_gasFeeEstimates$medi2=gasFeeEstimates.medium)||void 0===_gasFeeEstimates$medi2?void 0:_gasFeeEstimates$medi2.suggestedMaxPriorityFeePerGas)??"0";if((0,_shared_modules_transaction_utils__WEBPACK_IMPORTED_MODULE_3__.K3)(transaction)){var _transaction$txParams3,_transaction$txParams4;const transactionMaxFeePerGas=null===(_transaction$txParams3=transaction.txParams)||void 0===_transaction$txParams3?void 0:_transaction$txParams3.maxFeePerGas,transactionMaxPriorityFeePerGas=null===(_transaction$txParams4=transaction.txParams)||void 0===_transaction$txParams4?void 0:_transaction$txParams4.maxPriorityFeePerGas;temporaryGasSettings.maxFeePerGas=void 0===transactionMaxFeePerGas||transactionMaxFeePerGas.startsWith("-")?"0x0":getHighestIncrementedFee(transactionMaxFeePerGas,suggestedMaxFeePerGas),temporaryGasSettings.maxPriorityFeePerGas=void 0===transactionMaxPriorityFeePerGas||transactionMaxPriorityFeePerGas.startsWith("-")?"0x0":getHighestIncrementedFee(transactionMaxPriorityFeePerGas,suggestedMaxPriorityFeePerGas)}else{var _transaction$txParams5;const transactionGasPrice=null===(_transaction$txParams5=transaction.txParams)||void 0===_transaction$txParams5?void 0:_transaction$txParams5.gasPrice;temporaryGasSettings.gasPrice=void 0===transactionGasPrice||transactionGasPrice.startsWith("-")?"0x0":getHighestIncrementedFee(transactionGasPrice,suggestedMaxFeePerGas)}return temporaryGasSettings}),[transaction,gasFeeEstimates])}},"./node_modules/lodash/isEqual.js":(module,__unused_webpack_exports,__webpack_require__)=>{var baseIsEqual=__webpack_require__("./node_modules/lodash/_baseIsEqual.js");module.exports=function isEqual(value,other){return baseIsEqual(value,other)}}}]);