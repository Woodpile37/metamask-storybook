"use strict";(globalThis.webpackChunkmetamask_crx=globalThis.webpackChunkmetamask_crx||[]).push([[8161],{"./ui/pages/permissions-connect/snaps/snaps-connect/snaps-connect.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DefaultStory:()=>DefaultStory,MultiStory:()=>MultiStory,ScrollingStory:()=>ScrollingStory,__namedExportsOrder:()=>__namedExportsOrder,default:()=>snaps_connect_stories});var _DefaultStory$paramet,_DefaultStory$paramet2,_MultiStory$parameter,_MultiStory$parameter2,_ScrollingStory$param,_ScrollingStory$param2,react=__webpack_require__("./node_modules/react/index.js"),es=__webpack_require__("./node_modules/react-redux/es/index.js"),store=__webpack_require__("./ui/store/store.ts"),mock_state=__webpack_require__("./test/data/mock-state.json"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),useI18nContext=__webpack_require__("./ui/hooks/useI18nContext.js"),box=__webpack_require__("./ui/components/ui/box/index.js"),site_origin=__webpack_require__("./ui/components/ui/site-origin/index.js"),component_library=__webpack_require__("./ui/components/component-library/index.ts"),design_system=__webpack_require__("./ui/helpers/constants/design-system.ts"),page_container=__webpack_require__("./ui/components/ui/page-container/index.js"),snap_connect_cell=__webpack_require__("./ui/components/app/snaps/snap-connect-cell/snap-connect-cell.js"),util=__webpack_require__("./ui/helpers/utils/util.js"),pulse_loader=__webpack_require__("./ui/components/ui/pulse-loader/pulse-loader.js"),snap_privacy_warning=__webpack_require__("./ui/components/app/snaps/snap-privacy-warning/snap-privacy-warning.js"),selectors=__webpack_require__("./ui/selectors/index.js"),snap_avatar=__webpack_require__("./ui/components/app/snaps/snap-avatar/snap-avatar.js"),useOriginMetadata=__webpack_require__("./ui/hooks/useOriginMetadata.js");function SnapsConnect({request,approveConnection,rejectConnection,targetSubjectMetadata,snapsInstallPrivacyWarningShown,setSnapsInstallPrivacyWarningShownStatus}){const t=(0,useI18nContext.C)(),{origin,iconUrl,name}=targetSubjectMetadata,[isLoading,setIsLoading]=(0,react.useState)(!1),[isShowingSnapsPrivacyWarning,setIsShowingSnapsPrivacyWarning]=(0,react.useState)(!snapsInstallPrivacyWarningShown),currentPermissions=(0,es.v9)((state=>{var _request$metadata;return(0,selectors.Zu$)(state,null==request||null===(_request$metadata=request.metadata)||void 0===_request$metadata?void 0:_request$metadata.origin)})),onCancel=(0,react.useCallback)((()=>{rejectConnection(request.metadata.id)}),[request,rejectConnection]),onConnect=(0,react.useCallback)((()=>{try{setIsLoading(!0),approveConnection(request)}finally{setIsLoading(!1)}}),[request,approveConnection]),snaps=(0,util.Q8)(request,currentPermissions),singularConnectSnapMetadata=(0,es.v9)((state=>(0,selectors.h5U)(state,null==snaps?void 0:snaps[0]))),SnapsConnectContent=()=>{const{hostname:trimmedOrigin}=(0,useOriginMetadata.j)(origin)||{};if(isLoading)return react.createElement(box.ZP,{className:"snap-connect__loader-container",flexDirection:design_system.Qb.Column,alignItems:design_system.g1.center,justifyContent:design_system.E0.center},react.createElement(pulse_loader.Z,null));if((null==snaps?void 0:snaps.length)>1)return react.createElement(box.ZP,{className:"snaps-connect__content",flexDirection:design_system.Qb.Column,justifyContent:design_system.E0.center,alignItems:design_system.g1.center,paddingLeft:4,paddingRight:4,paddingTop:8,width:design_system.Sw.Full,style:{overflowY:"hidden"}},react.createElement(component_library.xv,{paddingBottom:2,variant:design_system.rK.headingLg},t("connectionRequest")),react.createElement(component_library.xv,{variant:design_system.rK.bodyMd,textAlign:design_system.PH.Center},t("multipleSnapConnectionWarning",[react.createElement(component_library.xv,{as:component_library.Tc.Span,key:"1",variant:design_system.rK.bodyMd,fontWeight:design_system.U9.Medium},trimmedOrigin),react.createElement(component_library.xv,{as:component_library.Tc.Span,key:"2",variant:design_system.rK.bodyMd,fontWeight:design_system.U9.Medium},null==snaps?void 0:snaps.length)])),react.createElement(box.ZP,{className:"snaps-connect__content__snaps-list",flexDirection:design_system.Qb.Column,display:design_system.sS.Flex,marginTop:4,width:design_system.Sw.Full,style:{overflowY:"auto",flex:1}},snaps.map((snap=>react.createElement(snap_connect_cell.Z,{key:`snaps-connect-${snap}`,snapId:snap,origin:trimmedOrigin})))));if(1===(null==snaps?void 0:snaps.length)){const snapId=snaps[0],snapName=(0,util.NZ)(snapId,singularConnectSnapMetadata);return react.createElement(box.ZP,{className:"snaps-connect__content",flexDirection:design_system.Qb.Column,justifyContent:design_system.E0.center,alignItems:design_system.g1.center,height:design_system.Sw.Full,paddingLeft:4,paddingRight:4},react.createElement(box.ZP,{paddingBottom:2},react.createElement(snap_avatar.Z,{snapId:snaps[0],badgeSize:component_library.Jh.Md,avatarSize:component_library.Jh.Xl,borderWidth:3})),react.createElement(component_library.xv,{paddingBottom:2,variant:design_system.rK.headingLg},t("connectionRequest")),react.createElement(component_library.xv,{variant:design_system.rK.bodyMd,textAlign:design_system.PH.Center,padding:[0,4],overflowWrap:design_system.mn.Anywhere},t("snapConnectionWarning",[react.createElement(component_library.xv,{as:component_library.Tc.Span,key:"1",variant:design_system.rK.bodyMd,fontWeight:design_system.U9.Medium},trimmedOrigin),react.createElement(component_library.xv,{as:component_library.Tc.Span,key:"2",variant:design_system.rK.bodyMd,fontWeight:design_system.U9.Medium},snapName)])))}return null};return react.createElement(box.ZP,{className:"page-container snaps-connect",flexDirection:design_system.Qb.Column,alignItems:design_system.g1.center},isShowingSnapsPrivacyWarning&&react.createElement(snap_privacy_warning.Z,{onAccepted:()=>{setIsShowingSnapsPrivacyWarning(!1),setSnapsInstallPrivacyWarningShownStatus(!0)},onCanceled:onCancel}),react.createElement(box.ZP,{className:"snaps-connect__header",flexDirection:design_system.Qb.Column,alignItems:design_system.g1.center,paddingLeft:4,paddingRight:4},react.createElement(site_origin.Z,{chip:!0,siteOrigin:origin,title:origin,iconSrc:iconUrl,iconName:name})),react.createElement(SnapsConnectContent,null),react.createElement(page_container.g$,{footerClassName:"snaps-connect__footer",cancelButtonType:"default",hideCancel:!1,disabled:isLoading,onCancel,cancelText:t("cancel"),onSubmit:onConnect,submitText:t("connect")}))}SnapsConnect.propTypes={request:prop_types_default().object.isRequired,approveConnection:prop_types_default().func.isRequired,rejectConnection:prop_types_default().func.isRequired,targetSubjectMetadata:prop_types_default().shape({extensionId:prop_types_default().string,iconUrl:prop_types_default().string,name:prop_types_default().string,origin:prop_types_default().string,subjectType:prop_types_default().string}),snapsInstallPrivacyWarningShown:prop_types_default().bool.isRequired,setSnapsInstallPrivacyWarningShownStatus:prop_types_default().func},SnapsConnect.__docgenInfo={description:"",methods:[],displayName:"SnapsConnect",props:{request:{description:"",type:{name:"object"},required:!0},approveConnection:{description:"",type:{name:"func"},required:!0},rejectConnection:{description:"",type:{name:"func"},required:!0},targetSubjectMetadata:{description:"",type:{name:"shape",value:{extensionId:{name:"string",required:!1},iconUrl:{name:"string",required:!1},name:{name:"string",required:!1},origin:{name:"string",required:!1},subjectType:{name:"string",required:!1}}},required:!1},snapsInstallPrivacyWarningShown:{description:"",type:{name:"bool"},required:!0},setSnapsInstallPrivacyWarningShownStatus:{description:"",type:{name:"func"},required:!1}}};const snaps_connect_stories_store=(0,store.Z)(mock_state),snaps_connect_stories={title:"Pages/Snaps/SnapConnect",component:SnapsConnect,argTypes:{},decorators:[story=>react.createElement(es.zt,{store:snaps_connect_stories_store},story())]},DefaultStory=args=>react.createElement(SnapsConnect,args);DefaultStory.storyName="Default",DefaultStory.args={request:{metadata:{id:"foo"},permissions:{wallet_snap:{caveats:[{value:{"npm:@metamask/test-snap-bip44":{}}}]}}},targetSubjectMetadata:{origin:"https://metamask.io"}};const MultiStory=args=>react.createElement(SnapsConnect,args);MultiStory.storyName="Multi",MultiStory.args={request:{metadata:{id:"foo"},permissions:{wallet_snap:{caveats:[{value:{"npm:@metamask/test-snap-bip44":{},"npm:@metamask/test-snap-bip32":{},"npm:@metamask/test-snap-getEntropy":{}}}]}}},targetSubjectMetadata:{origin:"https://metamask.io"}};const ScrollingStory=args=>react.createElement(SnapsConnect,args);ScrollingStory.storyName="Scrolling",ScrollingStory.args={request:{metadata:{id:"foo"},permissions:{wallet_snap:{caveats:[{value:{"npm:@metamask/test-snap-bip44":{},"npm:@metamask/test-snap-bip32":{},"npm:@metamask/test-snap-getEntropy":{},"npm:@metamask/test-snap-networkAccess":{},"npm:@metamask/test-snap-wasm":{},"npm:@metamask/test-snap-notify":{},"npm:@metamask/test-snap-dialog":{}}}]}}},targetSubjectMetadata:{origin:"https://metamask.io"}},DefaultStory.parameters={...DefaultStory.parameters,docs:{...null===(_DefaultStory$paramet=DefaultStory.parameters)||void 0===_DefaultStory$paramet?void 0:_DefaultStory$paramet.docs,source:{originalSource:"args => <SnapsConnect {...args} />",...null===(_DefaultStory$paramet2=DefaultStory.parameters)||void 0===_DefaultStory$paramet2||null===(_DefaultStory$paramet2=_DefaultStory$paramet2.docs)||void 0===_DefaultStory$paramet2?void 0:_DefaultStory$paramet2.source}}},MultiStory.parameters={...MultiStory.parameters,docs:{...null===(_MultiStory$parameter=MultiStory.parameters)||void 0===_MultiStory$parameter?void 0:_MultiStory$parameter.docs,source:{originalSource:"args => <SnapsConnect {...args} />",...null===(_MultiStory$parameter2=MultiStory.parameters)||void 0===_MultiStory$parameter2||null===(_MultiStory$parameter2=_MultiStory$parameter2.docs)||void 0===_MultiStory$parameter2?void 0:_MultiStory$parameter2.source}}},ScrollingStory.parameters={...ScrollingStory.parameters,docs:{...null===(_ScrollingStory$param=ScrollingStory.parameters)||void 0===_ScrollingStory$param?void 0:_ScrollingStory$param.docs,source:{originalSource:"args => <SnapsConnect {...args} />",...null===(_ScrollingStory$param2=ScrollingStory.parameters)||void 0===_ScrollingStory$param2||null===(_ScrollingStory$param2=_ScrollingStory$param2.docs)||void 0===_ScrollingStory$param2?void 0:_ScrollingStory$param2.source}}};const __namedExportsOrder=["DefaultStory","MultiStory","ScrollingStory"];DefaultStory.__docgenInfo={description:"",methods:[],displayName:"DefaultStory"},MultiStory.__docgenInfo={description:"",methods:[],displayName:"MultiStory"},ScrollingStory.__docgenInfo={description:"",methods:[],displayName:"ScrollingStory"}},"./ui/components/app/snaps/snap-connect-cell/snap-connect-cell.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>SnapConnectCell});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_10__),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-redux/es/index.js"),_ui_box__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ui/components/ui/box/index.js"),_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/helpers/constants/design-system.ts"),_helpers_utils_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ui/helpers/utils/util.js"),_component_library__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ui/components/component-library/index.ts"),_ui_tooltip_tooltip__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ui/components/ui/tooltip/tooltip.js"),_hooks_useI18nContext__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ui/hooks/useI18nContext.js"),_snap_avatar_snap_avatar__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./ui/components/app/snaps/snap-avatar/snap-avatar.js"),_selectors__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./ui/selectors/index.js");function SnapConnectCell({origin,snapId}){const t=(0,_hooks_useI18nContext__WEBPACK_IMPORTED_MODULE_7__.C)(),snapMetadata=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)((state=>(0,_selectors__WEBPACK_IMPORTED_MODULE_9__.h5U)(state,snapId))),friendlyName=(0,_helpers_utils_util__WEBPACK_IMPORTED_MODULE_4__.NZ)(snapId,snapMetadata);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_box__WEBPACK_IMPORTED_MODULE_2__.ZP,{alignItems:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_3__.g1.center,paddingTop:2,paddingBottom:2,display:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_3__.sS.Flex},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_snap_avatar_snap_avatar__WEBPACK_IMPORTED_MODULE_8__.Z,{snapId}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_box__WEBPACK_IMPORTED_MODULE_2__.ZP,{width:"full",marginLeft:4,marginRight:4},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_component_library__WEBPACK_IMPORTED_MODULE_5__.xv,null,t("connectSnap",[react__WEBPACK_IMPORTED_MODULE_0__.createElement(_component_library__WEBPACK_IMPORTED_MODULE_5__.xv,{as:_component_library__WEBPACK_IMPORTED_MODULE_5__.Tc.Span,key:"1",fontWeight:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_3__.U9.Bold},friendlyName)]))),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_box__WEBPACK_IMPORTED_MODULE_2__.ZP,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_tooltip_tooltip__WEBPACK_IMPORTED_MODULE_6__.Z,{html:react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",null,t("snapConnectionWarning",[react__WEBPACK_IMPORTED_MODULE_0__.createElement("b",{key:"0"},origin),react__WEBPACK_IMPORTED_MODULE_0__.createElement("b",{key:"1"},friendlyName)])),position:"bottom"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_component_library__WEBPACK_IMPORTED_MODULE_5__.JO,{color:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_3__.EY.iconMuted,name:_component_library__WEBPACK_IMPORTED_MODULE_5__.uH.Info,size:_component_library__WEBPACK_IMPORTED_MODULE_5__.Jh.Sm}))))}SnapConnectCell.propTypes={origin:prop_types__WEBPACK_IMPORTED_MODULE_10___default().string.isRequired,snapId:prop_types__WEBPACK_IMPORTED_MODULE_10___default().string.isRequired},SnapConnectCell.__docgenInfo={description:"",methods:[],displayName:"SnapConnectCell",props:{origin:{description:"",type:{name:"string"},required:!0},snapId:{description:"",type:{name:"string"},required:!0}}}},"./ui/components/app/snaps/snap-privacy-warning/snap-privacy-warning.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>SnapPrivacyWarning});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),useI18nContext=__webpack_require__("./ui/hooks/useI18nContext.js"),popover=__webpack_require__("./ui/components/ui/popover/index.js"),component_library=__webpack_require__("./ui/components/component-library/index.ts"),design_system=__webpack_require__("./ui/helpers/constants/design-system.ts"),useScrollRequired=__webpack_require__("./ui/hooks/useScrollRequired.js");const TERMS_OF_USE_LINK="https://consensys.io/terms-of-use/";function SnapPrivacyWarning({onAccepted,onCanceled}){const t=(0,useI18nContext.C)(),{isScrollable,isScrolledToBottom,scrollToBottom,ref,onScroll}=(0,useScrollRequired.s)();return react.createElement(popover.Z,{className:"snap-privacy-warning"},react.createElement(component_library.xu,null,react.createElement(component_library.xu,{className:"snap-privacy-warning__header",paddingLeft:4,paddingRight:4},react.createElement(component_library.xu,{marginTop:4,className:"snap-privacy-warning__header__info-icon",display:design_system.sS.Flex,justifyContent:design_system.E0.center,alignItems:design_system.g1.center},react.createElement(component_library.fM,{iconName:component_library.uH.Info,color:design_system.EY.infoDefault,backgroundColor:design_system.lP.primaryMuted,size:component_library.dt.Md})),react.createElement(component_library.xu,{className:"snap-privacy-warning__header__title",marginTop:4,marginBottom:4,display:design_system.sS.Flex,justifyContent:design_system.E0.center,alignItems:design_system.g1.center},react.createElement(component_library.xv,{variant:design_system.rK.headingMd,fontWeight:design_system.U9.Bold},t("thirdPartySoftware")))),react.createElement(component_library.xu,{paddingLeft:4,paddingRight:4,className:"snap-privacy-warning__content",ref,onScroll},react.createElement(component_library.xu,{className:"snap-privacy-warning__message"},react.createElement(component_library.xv,{variant:design_system.rK.bodyMd},t("snapsPrivacyWarningFirstMessage",[react.createElement(component_library.ZP,{key:"privacyNoticeTermsOfUseLink",size:component_library.o3.Inherit,href:TERMS_OF_USE_LINK,target:"_blank"}," ",t("snapsTermsOfUse")," ")])),react.createElement(component_library.xv,{variant:design_system.rK.bodyMd,paddingTop:6},t("snapsPrivacyWarningSecondMessage")),react.createElement(component_library.xv,{variant:design_system.rK.bodyMd,fontWeight:design_system.U9.Bold,paddingTop:6},t("snapsPrivacyWarningThirdMessage"))),isScrollable&&!isScrolledToBottom?react.createElement(component_library.fM,{className:"snap-privacy-warning__content__scroll-button","data-testid":"snap-privacy-warning-scroll",iconName:component_library.uH.Arrow2Down,backgroundColor:design_system.lP.infoDefault,color:design_system.EY.primaryInverse,onClick:scrollToBottom,style:{cursor:"pointer"}}):null),react.createElement(component_library.xu,{paddingLeft:4,paddingRight:4,paddingBottom:4,className:"snap-privacy-warning__footer"},react.createElement(component_library.xu,{className:"snap-privacy-warning__footer",marginTop:6,display:design_system.sS.Flex},react.createElement(component_library.zx,{variant:component_library.RN.SECONDARY,size:component_library.Gt.LG,width:design_system.Sw.Full,className:"snap-privacy-warning__cancel-button",onClick:onCanceled,marginRight:2},t("cancel")),react.createElement(component_library.zx,{variant:component_library.RN.PRIMARY,size:component_library.Gt.LG,width:design_system.Sw.Full,className:"snap-privacy-warning__ok-button",onClick:onAccepted,marginLeft:2,disabled:!isScrolledToBottom},t("accept"))))))}SnapPrivacyWarning.propTypes={onAccepted:prop_types_default().func.isRequired,onCanceled:prop_types_default().func.isRequired},SnapPrivacyWarning.__docgenInfo={description:"",methods:[],displayName:"SnapPrivacyWarning",props:{onAccepted:{description:"onAccepted handler",type:{name:"func"},required:!0},onCanceled:{description:"onCanceled handler",type:{name:"func"},required:!0}}}},"./ui/components/ui/site-origin/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>_site_origin__WEBPACK_IMPORTED_MODULE_0__.Z});var _site_origin__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ui/components/ui/site-origin/site-origin.js")},"./ui/hooks/useScrollRequired.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{s:()=>useScrollRequired});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),lodash__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash/lodash.js");const useScrollRequired=(dependencies=[])=>{const ref=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(),[isScrollableState,setIsScrollable]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[isScrolledToBottomState,setIsScrolledToBottom]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),update=()=>{if(!ref.current)return;const isScrollable=ref.current&&ref.current.scrollHeight>ref.current.clientHeight,isScrolledToBottom=isScrollable&&Math.round(ref.current.scrollTop)+ref.current.offsetHeight+16>=ref.current.scrollHeight;setIsScrollable(isScrollable),isScrollable&&!isScrolledToBottom||setIsScrolledToBottom(!0)};(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(update,[ref,...dependencies]);return{isScrollable:isScrollableState,isScrolledToBottom:isScrolledToBottomState,scrollToBottom:()=>{setIsScrolledToBottom(!0),ref.current&&ref.current.scrollTo(0,ref.current.scrollHeight)},ref,onScroll:(0,lodash__WEBPACK_IMPORTED_MODULE_1__.debounce)(update,25)}}}}]);