"use strict";(globalThis.webpackChunkmetamask_crx=globalThis.webpackChunkmetamask_crx||[]).push([[9469],{"./ui/components/app/currency-input/currency-input.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DefaultStory:()=>DefaultStory,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _DefaultStory$paramet,_DefaultStory$paramet2,_DefaultStory$paramet3,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),___WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ui/components/app/currency-input/index.js");const __WEBPACK_DEFAULT_EXPORT__={title:"Components/App/CurrencyInput",argTypes:{hexValue:{control:"text"},featureSecondary:{control:"boolean"},onChange:{action:"onChange"},onPreferenceToggle:{action:"onPreferenceToggle"}}},DefaultStory=args=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(___WEBPACK_IMPORTED_MODULE_1__.Z,args);DefaultStory.storyName="Default",DefaultStory.parameters={...DefaultStory.parameters,docs:{...null===(_DefaultStory$paramet=DefaultStory.parameters)||void 0===_DefaultStory$paramet?void 0:_DefaultStory$paramet.docs,source:{originalSource:"args => <CurrencyInput {...args} />",...null===(_DefaultStory$paramet2=DefaultStory.parameters)||void 0===_DefaultStory$paramet2||null===(_DefaultStory$paramet3=_DefaultStory$paramet2.docs)||void 0===_DefaultStory$paramet3?void 0:_DefaultStory$paramet3.source}}};const __namedExportsOrder=["DefaultStory"];DefaultStory.__docgenInfo={description:"",methods:[],displayName:"DefaultStory"}},"./ui/components/app/currency-input/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>CurrencyInput});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),es=__webpack_require__("./node_modules/react-redux/es/index.js"),unit_input=__webpack_require__("./ui/components/ui/unit-input/index.js"),currency_display=__webpack_require__("./ui/components/ui/currency-display/index.js"),i18n=__webpack_require__("./ui/contexts/i18n.js"),metamask=__webpack_require__("./ui/ducks/metamask/metamask.js"),selectors=__webpack_require__("./ui/selectors/index.js"),conversion_utils=__webpack_require__("./shared/modules/conversion.utils.ts"),common=__webpack_require__("./shared/constants/common.ts");function CurrencyInput({hexValue,featureSecondary,onChange,onPreferenceToggle}){const t=(0,react.useContext)(i18n.OO),preferredCurrency=(0,es.v9)(metamask.JK),secondaryCurrency=(0,es.v9)(selectors.TV3),conversionRate=(0,es.v9)(metamask.PC),hideSecondary=!(0,es.v9)(selectors.i8I),primarySuffix=preferredCurrency||common.E.ETH,secondarySuffix=secondaryCurrency.toUpperCase(),[isSwapped,setSwapped]=(0,react.useState)(!1),[newHexValue,setNewHexValue]=(0,react.useState)(hexValue),[shouldDisplayFiat,setShouldDisplayFiat]=(0,react.useState)(featureSecondary),shouldUseFiat=!hideSecondary&&Boolean(shouldDisplayFiat),initialDecimalValue=hexValue?(()=>{const decimalValueString=shouldUseFiat?(0,conversion_utils.nu)({value:hexValue,toCurrency:secondaryCurrency,conversionRate,numberOfDecimals:2}):(0,conversion_utils.nu)({value:hexValue,toCurrency:common.E.ETH,numberOfDecimals:8});return Number(decimalValueString)||0})():0,handleChange=newDecimalValue=>{const hexValueNew=shouldUseFiat?(0,conversion_utils.rS)({value:newDecimalValue,fromCurrency:secondaryCurrency,conversionRate,invertConversionRate:!0}):(0,conversion_utils.rS)({value:newDecimalValue,fromCurrency:common.E.ETH,fromDenomination:common.E.ETH,conversionRate});setNewHexValue(hexValueNew),onChange(hexValueNew),setSwapped(!isSwapped)};(0,react.useEffect)((()=>{setNewHexValue(hexValue)}),[hexValue]),(0,react.useEffect)((()=>{featureSecondary&&handleChange(initialDecimalValue)}),[featureSecondary,initialDecimalValue]);return react.createElement(unit_input.Z,{hexValue,preferredCurrency,secondaryCurrency,hideSecondary,featureSecondary,conversionRate,onChange,onPreferenceToggle,dataTestId:"currency-input",suffix:shouldUseFiat?secondarySuffix:primarySuffix,onChange:handleChange,value:initialDecimalValue,actionComponent:react.createElement("button",{className:"currency-input__swap-component","data-testid":"currency-swap",onClick:async()=>{await onPreferenceToggle(),setSwapped(!isSwapped),setShouldDisplayFiat(!shouldDisplayFiat)}},react.createElement("i",{className:"fa fa-retweet fa-lg"}))},(()=>{let currency,numberOfDecimals;return hideSecondary?react.createElement("div",{className:"currency-input__conversion-component"},t("noConversionRateAvailable")):(shouldUseFiat?(currency=preferredCurrency||common.E.ETH,numberOfDecimals=8):(currency=secondaryCurrency,numberOfDecimals=2),react.createElement(currency_display.Z,{className:"currency-input__conversion-component",currency,value:newHexValue,numberOfDecimals}))})())}CurrencyInput.propTypes={hexValue:prop_types_default().string,featureSecondary:prop_types_default().bool,onChange:prop_types_default().func,onPreferenceToggle:prop_types_default().func},CurrencyInput.__docgenInfo={description:"Component that allows user to enter currency values as a number, and props receive a converted\nhex value in WEI. props.value, used as a default or forced value, should be a hex value, which\ngets converted into a decimal value depending on the currency (ETH or Fiat).\n\n@param options0\n@param options0.hexValue\n@param options0.featureSecondary\n@param options0.onChange\n@param options0.onPreferenceToggle",methods:[],displayName:"CurrencyInput",props:{hexValue:{description:"",type:{name:"string"},required:!1},featureSecondary:{description:"",type:{name:"bool"},required:!1},onChange:{description:"",type:{name:"func"},required:!1},onPreferenceToggle:{description:"",type:{name:"func"},required:!1}}}},"./ui/components/ui/currency-display/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>CurrencyDisplay});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),useCurrencyDisplay=__webpack_require__("./ui/hooks/useCurrencyDisplay.js"),common=__webpack_require__("./shared/constants/common.ts");function CurrencyDisplay({value,displayValue,"data-testid":dataTestId,style,className,prefix,prefixComponent,hideLabel,hideTitle,numberOfDecimals,denomination,currency,suffix}){const[title,parts]=(0,useCurrencyDisplay._)(value,{displayValue,prefix,numberOfDecimals,hideLabel,denomination,currency,suffix});return react.createElement("div",{className:classnames_default()("currency-display-component",className),"data-testid":dataTestId,style,title:!hideTitle&&title||null},react.createElement("span",{className:"currency-display-component__prefix"},prefixComponent),react.createElement("span",{className:"currency-display-component__text"},parts.prefix,parts.value),parts.suffix&&react.createElement("span",{className:"currency-display-component__suffix"},parts.suffix))}CurrencyDisplay.propTypes={className:prop_types_default().string,currency:prop_types_default().string,"data-testid":prop_types_default().string,denomination:prop_types_default().oneOf([common.E.GWEI,common.E.ETH]),displayValue:prop_types_default().string,hideLabel:prop_types_default().bool,hideTitle:prop_types_default().bool,numberOfDecimals:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().number]),prefix:prop_types_default().string,prefixComponent:prop_types_default().node,style:prop_types_default().object,suffix:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().bool]),value:prop_types_default().string},CurrencyDisplay.__docgenInfo={description:"",methods:[],displayName:"CurrencyDisplay",props:{className:{description:"",type:{name:"string"},required:!1},currency:{description:"",type:{name:"string"},required:!1},"data-testid":{description:"",type:{name:"string"},required:!1},denomination:{description:"",type:{name:"enum",value:[{value:"EtherDenomination.GWEI",computed:!0},{value:"EtherDenomination.ETH",computed:!0}]},required:!1},displayValue:{description:"",type:{name:"string"},required:!1},hideLabel:{description:"",type:{name:"bool"},required:!1},hideTitle:{description:"",type:{name:"bool"},required:!1},numberOfDecimals:{description:"",type:{name:"union",value:[{name:"string"},{name:"number"}]},required:!1},prefix:{description:"",type:{name:"string"},required:!1},prefixComponent:{description:"",type:{name:"node"},required:!1},style:{description:"",type:{name:"object"},required:!1},suffix:{description:"",type:{name:"union",value:[{name:"string"},{name:"bool"}]},required:!1},value:{description:"",type:{name:"string"},required:!1}}}},"./ui/components/ui/unit-input/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>UnitInput});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames);function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!=typeof res)return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"==typeof key?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class UnitInput extends react.PureComponent{constructor(...args){super(...args),_defineProperty(this,"state",{value:this.props.value}),_defineProperty(this,"handleFocus",(()=>{this.unitInput.focus()})),_defineProperty(this,"handleInputFocus",(({target:{value}})=>{"0"===value&&this.setState({value:""})})),_defineProperty(this,"handleInputBlur",(({target:{value}})=>{""===value&&this.setState({value:"0"}),this.props.onBlur&&this.props.onBlur(value)})),_defineProperty(this,"handleChange",(event=>{const{value:userInput}=event.target;let value=userInput;userInput.length&&userInput.length>1&&(value=function removeLeadingZeroes(str){return str.replace(/^0*(?=\d)/u,"")}(userInput)),this.setState({value}),this.props.onChange(value)}))}componentDidUpdate(prevProps){const{value:prevPropsValue}=prevProps,{value:propsValue}=this.props,{value:stateValue}=this.state;prevPropsValue!==propsValue&&propsValue!==stateValue&&this.setState({value:propsValue})}getInputWidth(value){const valueString=String(value);return`${(valueString.length||1)+(valueString.match(/\./u)?-.5:0)+.5}ch`}render(){const{error,placeholder,suffix,actionComponent,children,dataTestId}=this.props,{value}=this.state;return react.createElement("div",{className:classnames_default()("unit-input",{"unit-input--error":error}),onClick:this.handleFocus},react.createElement("div",{className:"unit-input__inputs"},react.createElement("div",{className:"unit-input__input-container"},react.createElement("input",{"data-testid":dataTestId,type:"number",dir:"ltr",className:classnames_default()("unit-input__input"),value,placeholder,onChange:this.handleChange,onBlur:this.handleInputBlur,onFocus:this.handleInputFocus,style:{width:this.getInputWidth(value)},ref:ref=>{this.unitInput=ref},autoFocus:!0}),suffix?react.createElement("div",{className:"unit-input__suffix"},suffix):null),children),actionComponent)}}_defineProperty(UnitInput,"propTypes",{dataTestId:prop_types_default().string,children:prop_types_default().node,actionComponent:prop_types_default().node,error:prop_types_default().bool,onChange:prop_types_default().func,onBlur:prop_types_default().func,placeholder:prop_types_default().string,suffix:prop_types_default().string,value:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().number])}),_defineProperty(UnitInput,"defaultProps",{value:"",placeholder:"0"}),UnitInput.__docgenInfo={description:"Component that attaches a suffix or unit of measurement trailing user input, ex. 'ETH'. Also\nallows rendering a child component underneath the input to, for example, display conversions of\nthe shown suffix.",methods:[{name:"handleFocus",docblock:null,modifiers:[],params:[],returns:null},{name:"handleInputFocus",docblock:null,modifiers:[],params:[{name:"{ target: { value } }",type:null}],returns:null},{name:"handleInputBlur",docblock:null,modifiers:[],params:[{name:"{ target: { value } }",type:null}],returns:null},{name:"handleChange",docblock:null,modifiers:[],params:[{name:"event",type:null}],returns:null},{name:"getInputWidth",docblock:null,modifiers:[],params:[{name:"value",type:null}],returns:null}],displayName:"UnitInput",props:{value:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"union",value:[{name:"string"},{name:"number"}]},required:!1},placeholder:{defaultValue:{value:"'0'",computed:!1},description:"",type:{name:"string"},required:!1},dataTestId:{description:"",type:{name:"string"},required:!1},children:{description:"",type:{name:"node"},required:!1},actionComponent:{description:"",type:{name:"node"},required:!1},error:{description:"",type:{name:"bool"},required:!1},onChange:{description:"",type:{name:"func"},required:!1},onBlur:{description:"",type:{name:"func"},required:!1},suffix:{description:"",type:{name:"string"},required:!1}}}},"./ui/hooks/useCurrencyDisplay.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>useCurrencyDisplay});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-redux/es/index.js"),_helpers_utils_confirm_tx_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ui/helpers/utils/confirm-tx.util.ts"),_selectors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/selectors/index.js"),_ducks_metamask_metamask__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ui/ducks/metamask/metamask.js"),_shared_modules_conversion_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./shared/modules/conversion.utils.ts"),_shared_constants_network__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./shared/constants/network.ts"),_shared_modules_Numeric__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./shared/modules/Numeric.ts"),_shared_constants_common__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./shared/constants/common.ts");function useCurrencyDisplay(inputValue,{displayValue,prefix,numberOfDecimals,denomination,currency,...opts}){const currentCurrency=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_3__.TV3),nativeCurrency=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_ducks_metamask_metamask__WEBPACK_IMPORTED_MODULE_4__.JK),conversionRate=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_ducks_metamask_metamask__WEBPACK_IMPORTED_MODULE_4__.PC),isUserPreferredCurrency=currency===currentCurrency,value=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>displayValue||(currency===nativeCurrency||!isUserPreferredCurrency&&!nativeCurrency?new _shared_modules_Numeric__WEBPACK_IMPORTED_MODULE_7__.D(inputValue,16,_shared_constants_common__WEBPACK_IMPORTED_MODULE_8__.E.WEI).toDenomination(denomination||_shared_constants_common__WEBPACK_IMPORTED_MODULE_8__.E.ETH).round(numberOfDecimals||2).toBase(10).toString():isUserPreferredCurrency&&conversionRate?(0,_helpers_utils_confirm_tx_util__WEBPACK_IMPORTED_MODULE_2__.xG)((0,_shared_modules_conversion_utils__WEBPACK_IMPORTED_MODULE_5__.nu)({value:inputValue,fromCurrency:nativeCurrency,toCurrency:currency,conversionRate,numberOfDecimals:numberOfDecimals||2,toDenomination:denomination}),currency):null)),[inputValue,nativeCurrency,conversionRate,displayValue,numberOfDecimals,denomination,currency,isUserPreferredCurrency]);let suffix;if(!opts.hideLabel){const currencyTickerSymbol=Object.values(_shared_constants_network__WEBPACK_IMPORTED_MODULE_6__.VL).includes(currency)?currency:null==currency?void 0:currency.toUpperCase();suffix=opts.suffix||currencyTickerSymbol}return[`${prefix||""}${value}${suffix?` ${suffix}`:""}`,{prefix,value,suffix}]}}}]);