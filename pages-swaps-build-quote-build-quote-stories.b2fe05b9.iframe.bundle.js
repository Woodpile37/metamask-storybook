"use strict";(globalThis.webpackChunkmetamask_crx=globalThis.webpackChunkmetamask_crx||[]).push([[9146],{"./ui/pages/swaps/build-quote/build-quote.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DefaultStory:()=>DefaultStory,__namedExportsOrder:()=>__namedExportsOrder,default:()=>build_quote_stories});var react=__webpack_require__("./node_modules/react/index.js"),lodash=__webpack_require__("./node_modules/lodash/lodash.js"),test_data=__webpack_require__("./.storybook/test-data.js"),bignumber=__webpack_require__("./node_modules/bignumber.js/bignumber.js"),bignumber_default=__webpack_require__.n(bignumber),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),es=__webpack_require__("./node_modules/react-redux/es/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),react_router=__webpack_require__("./node_modules/react-router/esm/react-router.js"),dist=__webpack_require__("./node_modules/@metamask/etherscan-link/dist/index.js"),metametrics=__webpack_require__("./ui/contexts/metametrics.js"),assets_controllers_dist=__webpack_require__("./node_modules/@metamask/assets-controllers/dist/index.js"),token_util=__webpack_require__("./ui/helpers/utils/token-util.js"),selectors=__webpack_require__("./ui/selectors/index.js"),metamask=__webpack_require__("./ui/ducks/metamask/metamask.js"),swaps=__webpack_require__("./ui/ducks/swaps/swaps.js"),swaps_utils=__webpack_require__("./shared/modules/swaps.utils.js"),hexstring_utils=__webpack_require__("./shared/modules/hexstring-utils.ts"),constants_swaps=__webpack_require__("./shared/constants/swaps.ts"),network=__webpack_require__("./shared/constants/network.ts"),useEqualityCheck=__webpack_require__("./ui/hooks/useEqualityCheck.js");function getRenderableTokenData(token,contractExchangeRates,conversionRate,currentCurrency,chainId,tokenList){var _tokenList$address$to,_tokenList$address$to2;const{symbol,name,address,iconUrl,string,balance,decimals}=token;let contractExchangeRate;(0,swaps_utils.X)(symbol,chainId)?contractExchangeRate=1:string&&conversionRate>0&&(contractExchangeRate=contractExchangeRates[(0,hexstring_utils.QG)(address)]);const formattedFiat=(0,token_util.Hr)(contractExchangeRate,conversionRate,currentCurrency,string,symbol,!0)||"",rawFiat=formattedFiat?(0,token_util.Hr)(contractExchangeRate,conversionRate,currentCurrency,string,symbol,!1):"",chainIdForTokenIcons=chainId===network.vo.GOERLI?network.vo.MAINNET:chainId,usedIconUrl=(symbol===network.CE.ETH&&chainId===network.vo.MAINNET||symbol===network.CE.ETH&&chainId===network.vo.GOERLI||symbol===network.CE.BNB&&chainId===network.vo.BSC||symbol===network.CE.MATIC&&chainId===network.vo.POLYGON||symbol===network.CE.AVALANCHE&&chainId===network.vo.AVALANCHE||symbol===network.CE.ETH&&chainId===network.vo.OPTIMISM||symbol===network.CE.ETH&&chainId===network.vo.ARBITRUM||symbol===network.CE.ETH&&chainId===network.vo.LINEA_MAINNET||symbol===network.CE.ETH&&chainId===network.vo.ZKSYNC_ERA?iconUrl:(0,assets_controllers_dist.formatIconUrlWithProxy)({chainId:chainIdForTokenIcons,tokenAddress:address||""}))||(null==token?void 0:token.image);return{...token,primaryLabel:symbol,secondaryLabel:name||(null===(_tokenList$address$to=tokenList[null==address?void 0:address.toLowerCase()])||void 0===_tokenList$address$to?void 0:_tokenList$address$to.name),rightPrimaryLabel:string&&`${new(bignumber_default())(string).round(6).toString()} ${symbol}`,rightSecondaryLabel:formattedFiat,iconUrl:usedIconUrl,identiconAddress:usedIconUrl?null:address,balance,decimals,name:name||(null===(_tokenList$address$to2=tokenList[null==address?void 0:address.toLowerCase()])||void 0===_tokenList$address$to2?void 0:_tokenList$address$to2.name),rawFiat}}function useTokensToSearch({usersTokens=[],topTokens={},shuffledTokensList,tokenBucketPriority=constants_swaps.ZX.owned}){const chainId=(0,es.v9)(selectors.BVZ),tokenConversionRates=(0,es.v9)(selectors.fPF,lodash.isEqual),conversionRate=(0,es.v9)(metamask.PC),currentCurrency=(0,es.v9)(selectors.TV3),defaultSwapsToken=(0,es.v9)(selectors.gpy,es.wU),tokenList=(0,es.v9)(selectors.HJ,lodash.isEqual),memoizedTopTokens=(0,useEqualityCheck.F)(topTokens),memoizedUsersToken=(0,useEqualityCheck.F)(usersTokens),defaultToken=getRenderableTokenData(defaultSwapsToken,tokenConversionRates,conversionRate,currentCurrency,chainId,tokenList),memoizedDefaultToken=(0,useEqualityCheck.F)(defaultToken),swapsTokens=(0,es.v9)(swaps.Gs,lodash.isEqual)||[],tokensToSearch=swapsTokens.length?swapsTokens:[memoizedDefaultToken,...shuffledTokensList.filter((token=>token.symbol!==memoizedDefaultToken.symbol))],memoizedTokensToSearch=(0,useEqualityCheck.F)(tokensToSearch);return(0,react.useMemo)((()=>{const usersTokensAddressMap=memoizedUsersToken.reduce(((acc,token)=>({...acc,[token.address.toLowerCase()]:token})),{}),tokensToSearchBuckets={owned:[],top:[],others:[]};return(0,lodash.uniqBy)([memoizedDefaultToken,...memoizedTokensToSearch,...memoizedUsersToken],(token=>token.address.toLowerCase())).forEach((token=>{const renderableDataToken=getRenderableTokenData({...usersTokensAddressMap[token.address.toLowerCase()],...token},tokenConversionRates,conversionRate,currentCurrency,chainId,tokenList);tokenBucketPriority===constants_swaps.ZX.owned?(0,swaps_utils.X)(renderableDataToken.symbol,chainId)||usersTokensAddressMap[token.address.toLowerCase()]?tokensToSearchBuckets.owned.push(renderableDataToken):memoizedTopTokens[token.address.toLowerCase()]?tokensToSearchBuckets.top[memoizedTopTokens[token.address.toLowerCase()].index]=renderableDataToken:tokensToSearchBuckets.others.push(renderableDataToken):memoizedTopTokens[token.address.toLowerCase()]?tokensToSearchBuckets.top[memoizedTopTokens[token.address.toLowerCase()].index]=renderableDataToken:(0,swaps_utils.X)(renderableDataToken.symbol,chainId)||usersTokensAddressMap[token.address.toLowerCase()]?tokensToSearchBuckets.owned.push(renderableDataToken):tokensToSearchBuckets.others.push(renderableDataToken)})),tokensToSearchBuckets.owned=tokensToSearchBuckets.owned.sort((({rawFiat},{rawFiat:secondRawFiat})=>new(bignumber_default())(rawFiat||0).gt(secondRawFiat||0)?-1:1)),tokensToSearchBuckets.top=tokensToSearchBuckets.top.filter(Boolean),tokenBucketPriority===constants_swaps.ZX.owned?[...tokensToSearchBuckets.owned,...tokensToSearchBuckets.top,...tokensToSearchBuckets.others]:[...tokensToSearchBuckets.top,...tokensToSearchBuckets.owned,...tokensToSearchBuckets.others]}),[memoizedTokensToSearch,memoizedUsersToken,memoizedTopTokens,tokenConversionRates,conversionRate,currentCurrency,memoizedDefaultToken,chainId,tokenList,tokenBucketPriority])}var i18n=__webpack_require__("./ui/contexts/i18n.js"),dropdown_input_pair=__webpack_require__("./ui/pages/swaps/dropdown-input-pair/index.js"),dropdown_search_list=__webpack_require__("./ui/pages/swaps/dropdown-search-list/index.js"),slippage_buttons=__webpack_require__("./ui/pages/swaps/slippage-buttons/slippage-buttons.js"),info_tooltip=__webpack_require__("./ui/components/ui/info-tooltip/index.js"),actionable_message=__webpack_require__("./ui/components/ui/actionable-message/actionable-message.js"),routes=__webpack_require__("./ui/helpers/constants/routes.ts"),util=__webpack_require__("./ui/helpers/utils/util.js"),usePrevious=__webpack_require__("./ui/hooks/usePrevious.js"),useTokenTracker=__webpack_require__("./ui/hooks/useTokenTracker.js"),useTokenFiatAmount=__webpack_require__("./ui/hooks/useTokenFiatAmount.js"),confirm_tx_util=__webpack_require__("./ui/helpers/utils/confirm-tx.util.ts"),conversion_utils=__webpack_require__("./shared/modules/conversion.utils.ts");var constants_metametrics=__webpack_require__("./shared/constants/metametrics.ts"),actions=__webpack_require__("./ui/store/actions.ts"),swaps_util=__webpack_require__("./ui/pages/swaps/swaps.util.ts"),swaps_footer=__webpack_require__("./ui/pages/swaps/swaps-footer/index.js"),string_utils=__webpack_require__("./shared/modules/string-utils.ts"),transactions_controller_utils=__webpack_require__("./shared/lib/transactions-controller-utils.js"),lib_token_util=__webpack_require__("./shared/lib/token-util.ts"),lib_swaps_utils=__webpack_require__("./shared/lib/swaps-utils.js"),smart_transactions_popover=__webpack_require__("./ui/pages/swaps/prepare-swap-page/smart-transactions-popover.tsx");const fuseSearchKeys=[{name:"name",weight:.499},{name:"symbol",weight:.499},{name:"address",weight:.002}];let timeoutIdForQuotesPrefetching;function BuildQuote({ethBalance,selectedAccountAddress,shuffledTokensList}){var _SWAPS_CHAINID_DEFAUL;const t=(0,react.useContext)(i18n.OO),dispatch=(0,es.I0)(),history=(0,react_router.k6)(),trackEvent=(0,react.useContext)(metametrics.Wd),[fetchedTokenExchangeRate,setFetchedTokenExchangeRate]=(0,react.useState)(void 0),[verificationClicked,setVerificationClicked]=(0,react.useState)(!1),isFeatureFlagLoaded=(0,es.v9)(swaps.f7),balanceError=(0,es.v9)(swaps.nu),fetchParams=(0,es.v9)(swaps.Ky,lodash.isEqual),{sourceTokenInfo={},destinationTokenInfo={}}=(null==fetchParams?void 0:fetchParams.metaData)||{},tokens=(0,es.v9)(metamask.lz,lodash.isEqual),topAssets=(0,es.v9)(swaps.cF,lodash.isEqual),fromToken=(0,es.v9)(swaps.HT,lodash.isEqual),fromTokenInputValue=(0,es.v9)(swaps.bO),fromTokenError=(0,es.v9)(swaps.pN),maxSlippage=(0,es.v9)(swaps.pR),toToken=(0,es.v9)(swaps.m7,lodash.isEqual)||destinationTokenInfo,defaultSwapsToken=(0,es.v9)(selectors.gpy,lodash.isEqual),chainId=(0,es.v9)(selectors.BVZ),rpcPrefs=(0,es.v9)(selectors.Kzx,es.wU),tokenList=(0,es.v9)(selectors.HJ,lodash.isEqual),quotes=(0,es.v9)(swaps.QR,lodash.isEqual),areQuotesPresent=Object.keys(quotes).length>0,latestAddedTokenTo=(0,es.v9)(swaps.Fj,lodash.isEqual),tokenConversionRates=(0,es.v9)(selectors.fPF,lodash.isEqual),conversionRate=(0,es.v9)(metamask.PC),useCurrencyRateCheck=(0,es.v9)(selectors.nsI),hardwareWalletUsed=(0,es.v9)(selectors.E9i),hardwareWalletType=(0,es.v9)(selectors.Jos),smartTransactionsOptInStatus=(0,es.v9)(swaps.oD),smartTransactionsEnabled=(0,es.v9)(swaps.j),currentSmartTransactionsEnabled=(0,es.v9)(swaps.ui),smartTransactionFees=(0,es.v9)(swaps.cT),smartTransactionsOptInPopoverDisplayed=void 0!==smartTransactionsOptInStatus,currentSmartTransactionsError=(0,es.v9)(swaps.LL),currentCurrency=(0,es.v9)(selectors.TV3),showSmartTransactionsOptInPopover=smartTransactionsEnabled&&!smartTransactionsOptInPopoverDisplayed,fetchParamsFromToken=(0,swaps_utils.X)(null==sourceTokenInfo?void 0:sourceTokenInfo.symbol,chainId)?defaultSwapsToken:sourceTokenInfo,{loading,tokensWithBalances}=(0,useTokenTracker.S)({tokens}),fromTokenArray=!(0,swaps_utils.X)(null==fromToken?void 0:fromToken.symbol,chainId)&&null!=fromToken&&fromToken.balance?[fromToken]:[],usersTokens=(0,lodash.uniqBy)([...tokensWithBalances,...tokens,...fromTokenArray],"address"),memoizedUsersTokens=(0,useEqualityCheck.F)(usersTokens),selectedFromToken=getRenderableTokenData(fromToken||fetchParamsFromToken,tokenConversionRates,conversionRate,currentCurrency,chainId,tokenList),tokensToSearchSwapFrom=useTokensToSearch({usersTokens:memoizedUsersTokens,topTokens:topAssets,shuffledTokensList,tokenBucketPriority:constants_swaps.ZX.owned}),tokensToSearchSwapTo=useTokensToSearch({usersTokens:memoizedUsersTokens,topTokens:topAssets,shuffledTokensList,tokenBucketPriority:constants_swaps.ZX.top}),selectedToToken=tokensToSearchSwapFrom.find((({address})=>(0,string_utils.J)(address,null==toToken?void 0:toToken.address)))||toToken,toTokenIsNotDefault=(null==selectedToToken?void 0:selectedToToken.address)&&!(0,swaps_utils.N)(null==selectedToToken?void 0:selectedToToken.address,chainId),occurrences=Number((null==selectedToToken?void 0:selectedToToken.occurances)||(null==selectedToToken?void 0:selectedToToken.occurrences)||0),{address:fromTokenAddress,symbol:fromTokenSymbol,string:fromTokenString,decimals:fromTokenDecimals,balance:rawFromTokenBalance}=selectedFromToken||{},{address:toTokenAddress}=selectedToToken||{},fromTokenBalance=rawFromTokenBalance&&(0,transactions_controller_utils.cp)(rawFromTokenBalance,fromTokenDecimals).toString(10),prevFromTokenBalance=(0,usePrevious.D)(fromTokenBalance),swapFromTokenFiatValue=(0,useTokenFiatAmount.Q)(fromTokenAddress,fromTokenInputValue||0,fromTokenSymbol,{showFiat:useCurrencyRateCheck},!0),swapFromEthFiatValue=function useEthFiatAmount(ethAmount,overrides={},hideCurrencySymbol){const conversionRate=(0,es.v9)(metamask.PC),currentCurrency=(0,es.v9)(selectors.TV3),userPrefersShownFiat=(0,es.v9)(selectors.i8I),showFiat=overrides.showFiat??userPrefersShownFiat,formattedFiat=(0,react.useMemo)((()=>(0,conversion_utils.NQ)(ethAmount,currentCurrency,conversionRate)),[conversionRate,currentCurrency,ethAmount]);if(showFiat&&"ETH"!==currentCurrency.toUpperCase()&&!(conversionRate<=0)&&void 0!==ethAmount)return hideCurrencySymbol?(0,confirm_tx_util.xG)(formattedFiat,currentCurrency):`${(0,confirm_tx_util.xG)(formattedFiat,currentCurrency)} ${currentCurrency.toUpperCase()}`}(fromTokenInputValue||0,{showFiat:useCurrencyRateCheck},!0),swapFromFiatValue=(0,swaps_utils.X)(fromTokenSymbol,chainId)?swapFromEthFiatValue:swapFromTokenFiatValue,onInputChange=(0,react.useCallback)(((newInputValue,balance)=>{dispatch((0,swaps.Kh)(newInputValue));const newBalanceError=new(bignumber_default())(newInputValue||0).gt(balance||0);balanceError!==newBalanceError&&dispatch((0,swaps.uS)(newBalanceError)),dispatch((0,swaps.uL)(fromToken&&(0,swaps_util.cR)(newInputValue)>fromToken.decimals?"tooManyDecimals":null))}),[dispatch,fromToken,balanceError]),onFromSelect=token=>{null!=token&&token.address&&!swapFromFiatValue&&null!==fetchedTokenExchangeRate?(0,swaps_util.xx)(token.address).then((rate=>{null!=rate&&setFetchedTokenExchangeRate(rate)})):setFetchedTokenExchangeRate(null),null!=token&&token.address&&!memoizedUsersTokens.find((usersToken=>(0,string_utils.J)(usersToken.address,token.address)))&&(0,lib_token_util.bn)(token.address,selectedAccountAddress,__webpack_require__.g.ethereumProvider).then((fetchedBalance=>{if(null!=fetchedBalance&&fetchedBalance.balance){const balanceAsDecString=fetchedBalance.balance.toString(10),userTokenBalance=(0,transactions_controller_utils.cp)(balanceAsDecString,token.decimals);dispatch((0,swaps.ZG)({...token,string:userTokenBalance.toString(10),balance:balanceAsDecString}))}})),dispatch((0,swaps.ZG)(token)),onInputChange(null!=token&&token.address?fromTokenInputValue:"",token.string,token.decimals)},blockExplorerTokenLink=(0,dist.getTokenTrackerLink)(selectedToToken.address,chainId,null,null,{blockExplorerUrl:constants_swaps.k3[chainId]??null}),blockExplorerLabel=rpcPrefs.blockExplorerUrl?(0,util.Cs)(blockExplorerTokenLink):t("etherscan"),{address:toAddress}=toToken||{},onToSelect=(0,react.useCallback)((token=>{latestAddedTokenTo&&token.address!==toAddress&&dispatch((0,actions.iUk)({tokensToIgnore:toAddress,dontShowLoadingIndicator:!0})),dispatch((0,swaps.FK)(token)),setVerificationClicked(!1)}),[dispatch,latestAddedTokenTo,toAddress]),hideDropdownItemIf=(0,react.useCallback)((item=>(0,string_utils.J)(item.address,fromTokenAddress)),[fromTokenAddress]),tokensWithBalancesFromToken=tokensWithBalances.find((token=>(0,string_utils.J)(token.address,null==fromToken?void 0:fromToken.address))),previousTokensWithBalancesFromToken=(0,usePrevious.D)(tokensWithBalancesFromToken);(0,react.useEffect)((()=>{const notDefault=!(0,swaps_utils.N)(null==tokensWithBalancesFromToken?void 0:tokensWithBalancesFromToken.address,chainId),addressesAreTheSame=(0,string_utils.J)(null==tokensWithBalancesFromToken?void 0:tokensWithBalancesFromToken.address,null==previousTokensWithBalancesFromToken?void 0:previousTokensWithBalancesFromToken.address),balanceHasChanged=(null==tokensWithBalancesFromToken?void 0:tokensWithBalancesFromToken.balance)!==(null==previousTokensWithBalancesFromToken?void 0:previousTokensWithBalancesFromToken.balance);notDefault&&addressesAreTheSame&&balanceHasChanged&&dispatch((0,swaps.ZG)({...fromToken,balance:null==tokensWithBalancesFromToken?void 0:tokensWithBalancesFromToken.balance,string:null==tokensWithBalancesFromToken?void 0:tokensWithBalancesFromToken.string}))}),[dispatch,tokensWithBalancesFromToken,previousTokensWithBalancesFromToken,fromToken,chainId]),(0,react.useEffect)((()=>{(0,swaps_utils.N)(null==fromToken?void 0:fromToken.address,chainId)&&(null==fromToken?void 0:fromToken.balance)!==(0,conversion_utils.Z8)(ethBalance)&&dispatch((0,swaps.ZG)({...fromToken,balance:(0,conversion_utils.Z8)(ethBalance),string:(0,conversion_utils.nu)({value:ethBalance,numberOfDecimals:4,toDenomination:"ETH"})}))}),[dispatch,fromToken,ethBalance,chainId]),(0,react.useEffect)((()=>{prevFromTokenBalance!==fromTokenBalance&&onInputChange(fromTokenInputValue,fromTokenBalance)}),[onInputChange,prevFromTokenBalance,fromTokenInputValue,fromTokenBalance]);const trackBuildQuotePageLoadedEvent=(0,react.useCallback)((()=>{trackEvent({event:"Build Quote Page Loaded",category:constants_metametrics.ci.Swaps,sensitiveProperties:{is_hardware_wallet:hardwareWalletUsed,hardware_wallet_type:hardwareWalletType,stx_enabled:smartTransactionsEnabled,current_stx_enabled:currentSmartTransactionsEnabled,stx_user_opt_in:smartTransactionsOptInStatus}})}),[trackEvent,hardwareWalletUsed,hardwareWalletType,smartTransactionsEnabled,currentSmartTransactionsEnabled,smartTransactionsOptInStatus]);(0,react.useEffect)((()=>{dispatch((0,actions.YuM)()),dispatch((0,swaps.Nx)()),trackBuildQuotePageLoadedEvent()}),[dispatch,trackBuildQuotePageLoadedEvent]),(0,react.useEffect)((()=>{smartTransactionsEnabled&&null!=smartTransactionFees&&smartTransactionFees.tradeTxFees&&(0,actions.QJ$)()}),[smartTransactionsEnabled,smartTransactionFees]);const BlockExplorerLink=()=>react.createElement("a",{className:"build-quote__token-etherscan-link build-quote__underline",key:"build-quote-etherscan-link",onClick:()=>{trackEvent({event:constants_metametrics.AW.ExternalLinkClicked,category:constants_metametrics.ci.Swaps,properties:{link_type:constants_metametrics.ls.TokenTracker,location:"Swaps Confirmation",url_domain:(0,util.Cs)(blockExplorerTokenLink)}}),__webpack_require__.g.platform.openTab({url:blockExplorerTokenLink})},target:"_blank",rel:"noopener noreferrer"},blockExplorerLabel);let tokenVerificationDescription="";blockExplorerTokenLink&&(1===occurrences?tokenVerificationDescription=t("verifyThisTokenOn",[react.createElement(BlockExplorerLink,{key:"block-explorer-link"})]):0===occurrences&&(tokenVerificationDescription=t("verifyThisUnconfirmedTokenOn",[react.createElement(BlockExplorerLink,{key:"block-explorer-link"})])));const swapYourTokenBalance=t("swapYourTokenBalance",[fromTokenString||"0",fromTokenSymbol||(null===(_SWAPS_CHAINID_DEFAUL=constants_swaps.gG[chainId])||void 0===_SWAPS_CHAINID_DEFAUL?void 0:_SWAPS_CHAINID_DEFAUL.symbol)||""]),isDirectWrappingEnabled=(0,lib_swaps_utils.Fx)(chainId,fromTokenAddress,selectedToToken.address),isReviewSwapButtonDisabled=fromTokenError||!isFeatureFlagLoaded||!Number(fromTokenInputValue)||!(null!=selectedToToken&&selectedToToken.address)||!fromTokenAddress||Number(maxSlippage)<0||Number(maxSlippage)>constants_swaps.of||toTokenIsNotDefault&&occurrences<2&&!verificationClicked;return(0,react.useEffect)((()=>{dispatch((0,actions.gm2)()),dispatch((0,actions.otz)());return timeoutIdForQuotesPrefetching=setTimeout((()=>{timeoutIdForQuotesPrefetching=null,isReviewSwapButtonDisabled||(async()=>{await dispatch((0,swaps.lU)(history,fromTokenInputValue,maxSlippage,trackEvent,!0))})()}),1e3),()=>clearTimeout(timeoutIdForQuotesPrefetching)}),[dispatch,history,maxSlippage,trackEvent,isReviewSwapButtonDisabled,fromTokenInputValue,fromTokenAddress,toTokenAddress,smartTransactionsOptInStatus]),react.createElement("div",{className:"build-quote"},react.createElement("div",{className:"build-quote__content"},react.createElement(smart_transactions_popover.Z,{onStartSwapping:()=>(0,actions.sV)(!0,smartTransactionsOptInStatus),onManageStxInSettings:e=>{null==e||e.preventDefault(),(0,actions.sV)(!1,smartTransactionsOptInStatus)},isOpen:showSmartTransactionsOptInPopover}),react.createElement("div",{className:"build-quote__dropdown-input-pair-header"},react.createElement("div",{className:"build-quote__input-label"},t("swapSwapFrom")),!(0,swaps_utils.X)(fromTokenSymbol,chainId)&&react.createElement("div",{className:"build-quote__max-button","data-testid":"build-quote__max-button",onClick:()=>onInputChange(fromTokenBalance||"0",fromTokenBalance)},t("max"))),react.createElement(dropdown_input_pair.Z,{onSelect:onFromSelect,itemsToSearch:tokensToSearchSwapFrom,onInputChange:value=>{onInputChange(value,fromTokenBalance)},inputValue:fromTokenInputValue,leftValue:fromTokenInputValue&&swapFromFiatValue,selectedItem:selectedFromToken,maxListItems:30,loading:loading&&(!(null!=tokensToSearchSwapFrom&&tokensToSearchSwapFrom.length)||!topAssets||!Object.keys(topAssets).length),selectPlaceHolderText:t("swapSelect"),hideItemIf:item=>(0,string_utils.J)(item.address,null==selectedToToken?void 0:selectedToToken.address),listContainerClassName:"build-quote__open-dropdown",autoFocus:!0}),react.createElement("div",{className:classnames_default()("build-quote__balance-message",{"build-quote__balance-message--error":balanceError||fromTokenError})},!fromTokenError&&!balanceError&&fromTokenSymbol&&swapYourTokenBalance,!fromTokenError&&balanceError&&fromTokenSymbol&&react.createElement("div",{className:"build-quite__insufficient-funds"},react.createElement("div",{className:"build-quite__insufficient-funds-first"},t("swapsNotEnoughForTx",[fromTokenSymbol])),react.createElement("div",{className:"build-quite__insufficient-funds-second"},swapYourTokenBalance)),fromTokenError&&react.createElement(react.Fragment,null,react.createElement("div",{className:"build-quote__form-error"},t("swapTooManyDecimalsError",[fromTokenSymbol,fromTokenDecimals])),react.createElement("div",null,swapYourTokenBalance))),react.createElement("div",{className:"build-quote__swap-arrows-row"},react.createElement("button",{className:"build-quote__swap-arrows","data-testid":"build-quote__swap-arrows",onClick:()=>{onToSelect(selectedFromToken),onFromSelect(selectedToToken)}},react.createElement("i",{className:"fa fa-arrow-up",title:t("swapSwapSwitch")}),react.createElement("i",{className:"fa fa-arrow-down",title:t("swapSwapSwitch")}))),react.createElement("div",{className:"build-quote__dropdown-swap-to-header"},react.createElement("div",{className:"build-quote__input-label"},t("swapSwapTo"))),react.createElement("div",{className:"dropdown-input-pair dropdown-input-pair__to"},react.createElement(dropdown_search_list.Z,{startingItem:selectedToToken,itemsToSearch:tokensToSearchSwapTo,fuseSearchKeys,selectPlaceHolderText:t("swapSelectAToken"),maxListItems:30,onSelect:onToSelect,loading:loading&&(!(null!=tokensToSearchSwapTo&&tokensToSearchSwapTo.length)||!topAssets||!Object.keys(topAssets).length),externallySelectedItem:selectedToToken,hideItemIf:hideDropdownItemIf,listContainerClassName:"build-quote__open-to-dropdown",hideRightLabels:!0,defaultToAll:!0,shouldSearchForImports:!0})),toTokenIsNotDefault&&(occurrences<2?react.createElement(actionable_message.Z,{type:1===occurrences?"warning":"danger",message:react.createElement("div",{className:"build-quote__token-verification-warning-message"},react.createElement("div",{className:"build-quote__bold"},t(1===occurrences?"swapTokenVerificationOnlyOneSource":"swapTokenVerificationAddedManually")),react.createElement("div",null,tokenVerificationDescription)),primaryAction:verificationClicked?null:{label:t("continue"),onClick:()=>setVerificationClicked(!0)},withRightButton:!0,infoTooltipText:blockExplorerTokenLink&&t("swapVerifyTokenExplanation",[blockExplorerLabel])}):react.createElement("div",{className:"build-quote__token-message"},react.createElement("span",{className:"build-quote__bold",key:"token-verification-bold-text"},t("swapTokenVerificationSources",[occurrences])),blockExplorerTokenLink&&react.createElement(react.Fragment,null,t("swapTokenVerificationMessage",[react.createElement("a",{className:"build-quote__token-etherscan-link",key:"build-quote-etherscan-link",onClick:()=>{trackEvent({event:"Clicked Block Explorer Link",category:constants_metametrics.ci.Swaps,properties:{link_type:"Token Tracker",action:"Swaps Confirmation",block_explorer_domain:(0,util.Cs)(blockExplorerTokenLink)}}),__webpack_require__.g.platform.openTab({url:blockExplorerTokenLink})},target:"_blank",rel:"noopener noreferrer"},blockExplorerLabel)]),react.createElement(info_tooltip.Z,{position:"top",contentText:t("swapVerifyTokenExplanation",[blockExplorerLabel]),containerClassName:"build-quote__token-tooltip-container",key:"token-verification-info-tooltip"})))),(smartTransactionsEnabled||!smartTransactionsEnabled&&!isDirectWrappingEnabled)&&react.createElement("div",{className:"build-quote__slippage-buttons-container"},react.createElement(slippage_buttons.Z,{onSelect:newSlippage=>{dispatch((0,swaps.mN)(newSlippage))},maxAllowedSlippage:constants_swaps.of,currentSlippage:maxSlippage,smartTransactionsEnabled,smartTransactionsOptInStatus,setSmartTransactionsOptInStatus:actions.sV,currentSmartTransactionsError,isDirectWrappingEnabled}))),react.createElement(swaps_footer.Z,{onSubmit:async()=>{dispatch((0,swaps.Nx)(Date.now())),timeoutIdForQuotesPrefetching?(clearTimeout(timeoutIdForQuotesPrefetching),dispatch((0,swaps.lU)(history,fromTokenInputValue,maxSlippage,trackEvent))):areQuotesPresent?history.push(routes.x3):(await dispatch((0,actions.Civ)("loading")),history.push(routes.Kn))},submitText:t("swapReviewSwap"),disabled:isReviewSwapButtonDisabled,hideCancel:!0,showTermsOfService:!0}))}var _DefaultStory$paramet,_DefaultStory$paramet2;BuildQuote.propTypes={ethBalance:prop_types_default().string,selectedAccountAddress:prop_types_default().string,shuffledTokensList:prop_types_default().array},BuildQuote.__docgenInfo={description:"",methods:[],displayName:"BuildQuote",props:{ethBalance:{description:"",type:{name:"string"},required:!1},selectedAccountAddress:{description:"",type:{name:"string"},required:!1},shuffledTokensList:{description:"",type:{name:"array"},required:!1}}};const build_quote_stories={title:"Pages/Swaps/BuildQuote",argTypes:{ethBalance:{control:{type:"text"}},selectedAccountAddress:{control:{type:"text"}},shuffledTokensList:{control:"object"}},args:{ethBalance:"0x8",selectedAccountAddress:"0xb19ac54efa18cc3a14a5b821bfec73d284bf0c5e",shuffledTokensList:(0,lodash.shuffle)(test_data.default.metamask.tokenList)}},DefaultStory=args=>react.createElement(react.Fragment,null,react.createElement(BuildQuote,args));DefaultStory.storyName="Default",DefaultStory.parameters={...DefaultStory.parameters,docs:{...null===(_DefaultStory$paramet=DefaultStory.parameters)||void 0===_DefaultStory$paramet?void 0:_DefaultStory$paramet.docs,source:{originalSource:"args => {\n  return <>\n      <BuildQuote {...args} />\n    </>;\n}",...null===(_DefaultStory$paramet2=DefaultStory.parameters)||void 0===_DefaultStory$paramet2||null===(_DefaultStory$paramet2=_DefaultStory$paramet2.docs)||void 0===_DefaultStory$paramet2?void 0:_DefaultStory$paramet2.source}}};const __namedExportsOrder=["DefaultStory"];DefaultStory.__docgenInfo={description:"",methods:[],displayName:"DefaultStory"}},"./shared/lib/token-util.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{bn:()=>fetchTokenBalance});var _metamask_metamask_eth_abis__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@metamask/metamask-eth-abis/dist/index.js"),_ethersproject_contracts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@ethersproject/contracts/lib.esm/index.js"),_ethersproject_providers__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@ethersproject/providers/lib.esm/web3-provider.js");async function fetchTokenBalance(address,userAddress,provider){const ethersProvider=new _ethersproject_providers__WEBPACK_IMPORTED_MODULE_1__.Q(provider),tokenContract=new _ethersproject_contracts__WEBPACK_IMPORTED_MODULE_2__.Contract(address,_metamask_metamask_eth_abis__WEBPACK_IMPORTED_MODULE_0__.abiERC20,ethersProvider),tokenBalancePromise=tokenContract?tokenContract.balanceOf(userAddress):Promise.resolve();return await tokenBalancePromise}},"./ui/components/ui/button-group/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>ButtonGroup});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames);function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!=typeof res)return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"==typeof key?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class ButtonGroup extends react.PureComponent{constructor(...args){super(...args),_defineProperty(this,"state",{activeButtonIndex:this.props.noButtonActiveByDefault?null:this.props.defaultActiveButtonIndex})}componentDidUpdate(_,prevState){"number"==typeof this.props.newActiveButtonIndex&&prevState.activeButtonIndex!==this.props.newActiveButtonIndex&&this.setState({activeButtonIndex:this.props.newActiveButtonIndex})}handleButtonClick(activeButtonIndex){this.setState({activeButtonIndex})}renderButtons(){const{children,disabled,variant}=this.props;return react.Children.map(children,((child,index)=>child&&react.createElement("button",{role:"radiogroup"===variant?"radio":void 0,"aria-checked":index===this.state.activeButtonIndex,className:classnames_default()("button-group__button",child.props.className,{"radio-button":"radiogroup"===variant,"button-group__button--active":index===this.state.activeButtonIndex,"radio-button--active":"radiogroup"===variant&&index===this.state.activeButtonIndex}),"data-testid":`button-group__button${index}`,onClick:()=>{var _child$props$onClick,_child$props;this.handleButtonClick(index),null===(_child$props$onClick=(_child$props=child.props).onClick)||void 0===_child$props$onClick||_child$props$onClick.call(_child$props)},disabled:disabled||child.props.disabled,key:index},child.props.children)))}render(){const{className,style,variant}=this.props;return react.createElement("div",{className:classnames_default()(className,{"radio-button-group":"radiogroup"===variant}),role:"radiogroup"===variant?"radiogroup":void 0,style},this.renderButtons())}}_defineProperty(ButtonGroup,"propTypes",{defaultActiveButtonIndex:prop_types_default().number,noButtonActiveByDefault:prop_types_default().bool,disabled:prop_types_default().bool,children:prop_types_default().array,className:prop_types_default().string,style:prop_types_default().object,newActiveButtonIndex:prop_types_default().number,variant:prop_types_default().oneOf(["radiogroup","default"])}),_defineProperty(ButtonGroup,"defaultProps",{className:"button-group",defaultActiveButtonIndex:0,variant:"default"}),ButtonGroup.__docgenInfo={description:"",methods:[{name:"handleButtonClick",docblock:null,modifiers:[],params:[{name:"activeButtonIndex",type:null}],returns:null},{name:"renderButtons",docblock:null,modifiers:[],params:[],returns:null}],displayName:"ButtonGroup",props:{className:{defaultValue:{value:"'button-group'",computed:!1},description:"Adds a className to the root div of the of the ButtonGroup component",type:{name:"string"},required:!1},defaultActiveButtonIndex:{defaultValue:{value:"0",computed:!1},description:"change button active order",type:{name:"number"},required:!1},variant:{defaultValue:{value:"'default'",computed:!1},description:"options for rendering type of button, consist of 'default' and 'radiogroup'",type:{name:"enum",value:[{value:"'radiogroup'",computed:!1},{value:"'default'",computed:!1}]},required:!1},noButtonActiveByDefault:{description:"no button are active before clicked by the user",type:{name:"bool"},required:!1},disabled:{description:"disabling every button inside button group",type:{name:"bool"},required:!1},children:{description:"Children must be an array of button components",type:{name:"array"},required:!1},style:{description:"adding style for button group component",type:{name:"object"},required:!1},newActiveButtonIndex:{description:"updating value of active button in button group component",type:{name:"number"},required:!1}}}},"./ui/components/ui/page-container/page-container-footer/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>PageContainerFooter});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),ui_button=__webpack_require__("./ui/components/ui/button/index.js");function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!=typeof res)return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"==typeof key?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class PageContainerFooter extends react.Component{render(){const{children,onCancel,cancelText,onSubmit,submitText,disabled,submitButtonType,hideCancel,cancelButtonType,buttonSizeLarge=!1,footerClassName,footerButtonClassName}=this.props;return react.createElement("div",{className:classnames_default()("page-container__footer",footerClassName)},react.createElement("footer",null,!hideCancel&&react.createElement(ui_button.Z,{type:cancelButtonType||"secondary",large:buttonSizeLarge,className:classnames_default()("page-container__footer-button","page-container__footer-button__cancel",footerButtonClassName),onClick:e=>onCancel(e),"data-testid":"page-container-footer-cancel"},cancelText||this.context.t("cancel")),react.createElement(ui_button.Z,{type:submitButtonType||"primary",large:buttonSizeLarge,className:classnames_default()("page-container__footer-button",footerButtonClassName),disabled,onClick:e=>onSubmit(e),"data-testid":"page-container-footer-next"},submitText||this.context.t("next"))),children&&react.createElement("div",{className:"page-container__footer-secondary"},children))}}_defineProperty(PageContainerFooter,"propTypes",{children:prop_types_default().node,onCancel:prop_types_default().func,cancelText:prop_types_default().string,cancelButtonType:prop_types_default().string,onSubmit:prop_types_default().func,submitText:prop_types_default().string,disabled:prop_types_default().bool,submitButtonType:prop_types_default().string,hideCancel:prop_types_default().bool,buttonSizeLarge:prop_types_default().bool,footerClassName:prop_types_default().string,footerButtonClassName:prop_types_default().string}),_defineProperty(PageContainerFooter,"contextTypes",{t:prop_types_default().func}),PageContainerFooter.__docgenInfo={description:"",methods:[],displayName:"PageContainerFooter",props:{children:{description:"",type:{name:"node"},required:!1},onCancel:{description:"",type:{name:"func"},required:!1},cancelText:{description:"",type:{name:"string"},required:!1},cancelButtonType:{description:"",type:{name:"string"},required:!1},onSubmit:{description:"",type:{name:"func"},required:!1},submitText:{description:"",type:{name:"string"},required:!1},disabled:{description:"",type:{name:"bool"},required:!1},submitButtonType:{description:"",type:{name:"string"},required:!1},hideCancel:{description:"",type:{name:"bool"},required:!1},buttonSizeLarge:{description:"",type:{name:"bool"},required:!1},footerClassName:{description:"",type:{name:"string"},required:!1},footerButtonClassName:{description:"",type:{name:"string"},required:!1}},context:{t:{type:{name:"func"},required:!1}}}},"./ui/pages/swaps/dropdown-input-pair/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>DropdownInputPair});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),dropdown_search_list=__webpack_require__("./ui/pages/swaps/dropdown-search-list/index.js"),text_field=__webpack_require__("./ui/components/ui/text-field/index.js");const characterWidthMap={1:5.86,2:10.05,3:10.45,4:11.1,5:10,6:10.06,7:9.17,8:10.28,9:10.06,0:11.22,".":4.55},getInputWidth=value=>String(value).split("").reduce(((inputWidth,_char)=>inputWidth+characterWidthMap[_char]),12);function DropdownInputPair({itemsToSearch=[],onInputChange,inputValue="",onSelect,leftValue,selectedItem,SearchListPlaceholder,maxListItems,selectPlaceHolderText,loading,hideItemIf,listContainerClassName,autoFocus}){const[isOpen,setIsOpen]=(0,react.useState)(!1),inputRef=(0,react.useRef)(),[applyTwoLineStyle,setApplyTwoLineStyle]=(0,react.useState)(null);return(0,react.useEffect)((()=>{var _inputRef$current;setApplyTwoLineStyle(((null==inputRef||null===(_inputRef$current=inputRef.current)||void 0===_inputRef$current||null===(_inputRef$current=_inputRef$current.getBoundingClientRect())||void 0===_inputRef$current?void 0:_inputRef$current.width)||0)+getInputWidth(inputValue||"")>137)}),[inputValue,inputRef]),react.createElement("div",{className:"dropdown-input-pair"},react.createElement(dropdown_search_list.Z,{itemsToSearch,SearchListPlaceholder,fuseSearchKeys:[{name:"name",weight:.499},{name:"symbol",weight:.499},{name:"address",weight:.002}],maxListItems,onOpen:()=>setIsOpen(!0),onClose:()=>setIsOpen(!1),onSelect,className:isOpen?"dropdown-input-pair__list--full-width":"",externallySelectedItem:selectedItem,selectPlaceHolderText,selectorClosedClassName:"dropdown-input-pair__selector--closed",listContainerClassName,loading,hideItemIf,defaultToAll:!0}),!isOpen&&react.createElement(text_field.Z,{className:classnames_default()("dropdown-input-pair__input",{"dropdown-input-pair__two-line-input":applyTwoLineStyle}),type:"text",placeholder:"0",onChange:event=>{event.stopPropagation();const valueToUse="."===event.target.value?"0.":event.target.value;""===valueToUse||/^(\.\d+|\d+(\.\d+)?|\d+\.)$/u.test(valueToUse)?onInputChange(valueToUse):onInputChange(inputValue||"")},fullWidth:!0,margin:"dense",value:inputValue,autoFocus}),!isOpen&&leftValue&&react.createElement("div",{className:classnames_default()("dropdown-input-pair__left-value",{"dropdown-input-pair__left-value--two-lines":applyTwoLineStyle}),ref:inputRef},"≈ ",leftValue))}DropdownInputPair.propTypes={itemsToSearch:prop_types_default().array,onInputChange:prop_types_default().func,inputValue:prop_types_default().oneOfType([prop_types_default().number,prop_types_default().string]),onSelect:prop_types_default().func,leftValue:prop_types_default().string,selectedItem:prop_types_default().object,SearchListPlaceholder:prop_types_default().func,maxListItems:prop_types_default().number,selectPlaceHolderText:prop_types_default().string,loading:prop_types_default().bool,hideItemIf:prop_types_default().func,listContainerClassName:prop_types_default().string,autoFocus:prop_types_default().bool},DropdownInputPair.__docgenInfo={description:"",methods:[],displayName:"DropdownInputPair",props:{itemsToSearch:{defaultValue:{value:"[]",computed:!1},description:"Give items data for the component",type:{name:"array"},required:!1},inputValue:{defaultValue:{value:"''",computed:!1},description:"Show input value content",type:{name:"union",value:[{name:"number"},{name:"string"}]},required:!1},onInputChange:{description:"Handler for input change",type:{name:"func"},required:!1},onSelect:{description:"Handler for onSelect",type:{name:"func"},required:!1},leftValue:{description:"Set value to left",type:{name:"string"},required:!1},selectedItem:{description:"Show selected item",type:{name:"object"},required:!1},SearchListPlaceholder:{description:"Doesn't look like this is used",type:{name:"func"},required:!1},maxListItems:{description:"Define maximum item per list",type:{name:"number"},required:!1},selectPlaceHolderText:{description:"Show select placeholder text",type:{name:"string"},required:!1},loading:{description:"Check if the component is loading",type:{name:"bool"},required:!1},hideItemIf:{description:"Handler for hide item",type:{name:"func"},required:!1},listContainerClassName:{description:"Add custom CSS class for list container",type:{name:"string"},required:!1},autoFocus:{description:"Check if the component is auto focus",type:{name:"bool"},required:!1}}}},"./ui/pages/swaps/prepare-swap-page/smart-transactions-popover.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>SmartTransactionsPopover});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_hooks_useI18nContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ui/hooks/useI18nContext.js"),_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ui/helpers/constants/design-system.ts"),_components_component_library__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/components/component-library/index.ts"),_components_component_library_modal_content_deprecated__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ui/components/component-library/modal-content/deprecated/index.ts"),_components_component_library_modal_header_deprecated__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ui/components/component-library/modal-header/deprecated/index.ts"),_shared_constants_swaps__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./shared/constants/swaps.ts");function SmartTransactionsPopover({onStartSwapping,onManageStxInSettings,isOpen}){const t=(0,_hooks_useI18nContext__WEBPACK_IMPORTED_MODULE_1__.C)();return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library__WEBPACK_IMPORTED_MODULE_3__.u_,{isOpen,onClose:onStartSwapping,isClosedOnOutsideClick:!1,isClosedOnEscapeKey:!1,className:"mm-modal__custom-scrollbar"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library__WEBPACK_IMPORTED_MODULE_3__.ZA,null),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library_modal_content_deprecated__WEBPACK_IMPORTED_MODULE_4__.h,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library_modal_header_deprecated__WEBPACK_IMPORTED_MODULE_5__.x,{alignItems:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.g1.center,justifyContent:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.E0.center},t("smartSwapsAreHere")),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library__WEBPACK_IMPORTED_MODULE_3__.xu,{display:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.sS.Flex,flexDirection:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.Qb.Column,gap:4,marginTop:4},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library__WEBPACK_IMPORTED_MODULE_3__.xu,{display:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.sS.Flex,flexDirection:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.Qb.Column},react__WEBPACK_IMPORTED_MODULE_0__.createElement("img",{src:"./images/logo/metamask-smart-transactions.png",alt:t("swapSwapSwitch")})),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library__WEBPACK_IMPORTED_MODULE_3__.xv,null,t("smartSwapsDescription")),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library__WEBPACK_IMPORTED_MODULE_3__.xv,{as:"ul",marginTop:3,marginBottom:3,style:{listStyle:"inside"}},react__WEBPACK_IMPORTED_MODULE_0__.createElement("li",{key:"stxBenefit1"},t("stxBenefit1")),react__WEBPACK_IMPORTED_MODULE_0__.createElement("li",{key:"stxBenefit2"},t("stxBenefit2")),react__WEBPACK_IMPORTED_MODULE_0__.createElement("li",{key:"stxBenefit3"},t("stxBenefit3")),react__WEBPACK_IMPORTED_MODULE_0__.createElement("li",{key:"stxBenefit4"},t("stxBenefit4"),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library__WEBPACK_IMPORTED_MODULE_3__.xv,{as:"span",fontWeight:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.U9.Normal}," *"))),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library__WEBPACK_IMPORTED_MODULE_3__.xv,{color:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.d9.textAlternative},t("smartSwapsDescription2",[react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library__WEBPACK_IMPORTED_MODULE_3__.ZP,{size:_components_component_library__WEBPACK_IMPORTED_MODULE_3__.o3.Inherit,href:_shared_constants_swaps__WEBPACK_IMPORTED_MODULE_6__.yS,externalLink:!0,display:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.sS.Inline,key:"smartSwapsDescription2"},t("faqAndRiskDisclosures"))])),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library__WEBPACK_IMPORTED_MODULE_3__.zx,{variant:_components_component_library__WEBPACK_IMPORTED_MODULE_3__.Wu.Primary,onClick:onStartSwapping,width:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.Sw.Full},t("enableSmartSwaps")),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library__WEBPACK_IMPORTED_MODULE_3__.zx,{type:"link",variant:_components_component_library__WEBPACK_IMPORTED_MODULE_3__.Wu.Link,onClick:onManageStxInSettings,width:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_2__.Sw.Full},t("manageInSettings")))))}try{smarttransactionspopover.displayName="smarttransactionspopover",smarttransactionspopover.__docgenInfo={description:"",displayName:"smarttransactionspopover",props:{onStartSwapping:{defaultValue:null,description:"",name:"onStartSwapping",required:!0,type:{name:"() => void"}},onManageStxInSettings:{defaultValue:null,description:"",name:"onManageStxInSettings",required:!0,type:{name:"() => void"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["ui/pages/swaps/prepare-swap-page/smart-transactions-popover.tsx#smarttransactionspopover"]={docgenInfo:smarttransactionspopover.__docgenInfo,name:"smarttransactionspopover",path:"ui/pages/swaps/prepare-swap-page/smart-transactions-popover.tsx#smarttransactionspopover"})}catch(__react_docgen_typescript_loader_error){}},"./ui/pages/swaps/slippage-buttons/slippage-buttons.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>SlippageButtons});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_12__),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_contexts_i18n__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ui/contexts/i18n.js"),_components_ui_button_group__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/components/ui/button-group/index.js"),_components_ui_button__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ui/components/ui/button/index.js"),_components_ui_info_tooltip__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ui/components/ui/info-tooltip/index.js"),_components_ui_toggle_button__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ui/components/ui/toggle-button/index.js"),_components_ui_box__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ui/components/ui/box/index.js"),_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./ui/helpers/constants/design-system.ts"),_swaps_util__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./ui/pages/swaps/swaps.util.ts"),_shared_constants_swaps__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./shared/constants/swaps.ts"),_components_component_library__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./ui/components/component-library/index.ts");function SlippageButtons({onSelect,maxAllowedSlippage,currentSlippage,smartTransactionsEnabled,smartTransactionsOptInStatus,setSmartTransactionsOptInStatus,currentSmartTransactionsError,isDirectWrappingEnabled}){const t=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_contexts_i18n__WEBPACK_IMPORTED_MODULE_2__.OO),[customValue,setCustomValue]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)((()=>"number"!=typeof currentSlippage||Object.values(_shared_constants_swaps__WEBPACK_IMPORTED_MODULE_10__.p6).includes(currentSlippage)?"":currentSlippage.toString())),[enteringCustomValue,setEnteringCustomValue]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[activeButtonIndex,setActiveButtonIndex]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)((()=>currentSlippage===_shared_constants_swaps__WEBPACK_IMPORTED_MODULE_10__.p6.high?1:currentSlippage===_shared_constants_swaps__WEBPACK_IMPORTED_MODULE_10__.p6.default?0:"number"==typeof currentSlippage?2:0)),[open,setOpen]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)((()=>currentSlippage!==_shared_constants_swaps__WEBPACK_IMPORTED_MODULE_10__.p6.default)),[inputRef,setInputRef]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);let errorText="";customValue&&(Number(customValue)<0?errorText=t("swapSlippageNegative"):Number(customValue)>0&&Number(customValue)<=1?errorText=t("swapLowSlippageError"):Number(customValue)>=5&&Number(customValue)<=maxAllowedSlippage?errorText=t("swapHighSlippageWarning"):Number(customValue)>maxAllowedSlippage&&(errorText=t("swapsExcessiveSlippageWarning")));const customValueText=customValue||t("swapCustom");return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{inputRef&&enteringCustomValue&&window.document.activeElement!==inputRef&&inputRef.focus()}),[inputRef,enteringCustomValue]),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"slippage-buttons"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{onClick:()=>setOpen(!open),className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("slippage-buttons__header",{"slippage-buttons__header--open":open})},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"slippage-buttons__header-text"},t("swapsAdvancedOptions")),open?react__WEBPACK_IMPORTED_MODULE_0__.createElement("i",{className:"fa fa-angle-up"}):react__WEBPACK_IMPORTED_MODULE_0__.createElement("i",{className:"fa fa-angle-down"})),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"slippage-buttons__content"},open&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,!isDirectWrappingEnabled&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"slippage-buttons__dropdown-content"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"slippage-buttons__buttons-prefix"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"slippage-buttons__prefix-text"},t("swapsMaxSlippage")),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_ui_info_tooltip__WEBPACK_IMPORTED_MODULE_5__.Z,{position:"top",contentText:t("swapSlippageTooltip")})),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_ui_button_group__WEBPACK_IMPORTED_MODULE_3__.Z,{defaultActiveButtonIndex:2!==activeButtonIndex||customValue?activeButtonIndex:1,variant:"radiogroup",newActiveButtonIndex:activeButtonIndex,className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("button-group","slippage-buttons__button-group")},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_ui_button__WEBPACK_IMPORTED_MODULE_4__.Z,{onClick:()=>{setCustomValue(""),setEnteringCustomValue(!1),setActiveButtonIndex(0),onSelect(_shared_constants_swaps__WEBPACK_IMPORTED_MODULE_10__.p6.default)}},t("swapSlippagePercent",[_shared_constants_swaps__WEBPACK_IMPORTED_MODULE_10__.p6.default])),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_ui_button__WEBPACK_IMPORTED_MODULE_4__.Z,{onClick:()=>{setCustomValue(""),setEnteringCustomValue(!1),setActiveButtonIndex(1),onSelect(_shared_constants_swaps__WEBPACK_IMPORTED_MODULE_10__.p6.high)}},t("swapSlippagePercent",[_shared_constants_swaps__WEBPACK_IMPORTED_MODULE_10__.p6.high])),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_ui_button__WEBPACK_IMPORTED_MODULE_4__.Z,{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("slippage-buttons__button-group-custom-button",{"radio-button--danger":errorText}),onClick:()=>{setActiveButtonIndex(2),setEnteringCustomValue(!0)}},enteringCustomValue?react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("slippage-buttons__custom-input",{"slippage-buttons__custom-input--danger":errorText})},react__WEBPACK_IMPORTED_MODULE_0__.createElement("input",{"data-testid":"slippage-buttons__custom-slippage",onChange:event=>{const{value}=event.target;!isNaN(Number(value))&&(setCustomValue(value),onSelect(Number(value)))},type:"text",maxLength:"4",ref:setInputRef,onBlur:()=>{setEnteringCustomValue(!1)},value:customValue||""})):customValueText,(customValue||enteringCustomValue)&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"slippage-buttons__percentage-suffix"},"%")))),smartTransactionsEnabled&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_ui_box__WEBPACK_IMPORTED_MODULE_7__.ZP,{marginTop:2,display:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_8__.sS.Flex},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_ui_box__WEBPACK_IMPORTED_MODULE_7__.ZP,{display:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_8__.sS.Flex,alignItems:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_8__.g1.center,paddingRight:3},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library__WEBPACK_IMPORTED_MODULE_11__.xv,{variant:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_8__.rK.bodySm,as:"h6",paddingRight:2,fontWeight:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_8__.U9.Bold},t("smartSwaps")),currentSmartTransactionsError?react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_ui_info_tooltip__WEBPACK_IMPORTED_MODULE_5__.Z,{position:"top",contentText:(0,_swaps_util__WEBPACK_IMPORTED_MODULE_9__.gq)(currentSmartTransactionsError,t)}):react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_ui_info_tooltip__WEBPACK_IMPORTED_MODULE_5__.Z,{position:"top",contentText:t("smartSwapsTooltip",[react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_component_library__WEBPACK_IMPORTED_MODULE_11__.ZP,{key:"smart-swaps-faq-and-risk-disclosures",size:_components_component_library__WEBPACK_IMPORTED_MODULE_11__.o3.Inherit,href:_shared_constants_swaps__WEBPACK_IMPORTED_MODULE_10__.yS,externalLink:!0,display:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_8__.sS.Inline},t("faqAndRiskDisclosures"))])})),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_ui_toggle_button__WEBPACK_IMPORTED_MODULE_6__.Z,{value:smartTransactionsOptInStatus,onToggle:value=>{setSmartTransactionsOptInStatus(!value,value)},offLabel:t("off"),onLabel:t("on"),disabled:Boolean(currentSmartTransactionsError)}))),errorText&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"slippage-buttons__error-text"},errorText)))}SlippageButtons.propTypes={onSelect:prop_types__WEBPACK_IMPORTED_MODULE_12___default().func.isRequired,maxAllowedSlippage:prop_types__WEBPACK_IMPORTED_MODULE_12___default().number.isRequired,currentSlippage:prop_types__WEBPACK_IMPORTED_MODULE_12___default().number,smartTransactionsEnabled:prop_types__WEBPACK_IMPORTED_MODULE_12___default().bool.isRequired,smartTransactionsOptInStatus:prop_types__WEBPACK_IMPORTED_MODULE_12___default().bool,setSmartTransactionsOptInStatus:prop_types__WEBPACK_IMPORTED_MODULE_12___default().func,currentSmartTransactionsError:prop_types__WEBPACK_IMPORTED_MODULE_12___default().string,isDirectWrappingEnabled:prop_types__WEBPACK_IMPORTED_MODULE_12___default().bool},SlippageButtons.__docgenInfo={description:"",methods:[],displayName:"SlippageButtons",props:{onSelect:{description:"",type:{name:"func"},required:!0},maxAllowedSlippage:{description:"",type:{name:"number"},required:!0},currentSlippage:{description:"",type:{name:"number"},required:!1},smartTransactionsEnabled:{description:"",type:{name:"bool"},required:!0},smartTransactionsOptInStatus:{description:"",type:{name:"bool"},required:!1},setSmartTransactionsOptInStatus:{description:"",type:{name:"func"},required:!1},currentSmartTransactionsError:{description:"",type:{name:"string"},required:!1},isDirectWrappingEnabled:{description:"",type:{name:"bool"},required:!1}}}},"./ui/pages/swaps/swaps-footer/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>SwapsFooter});var react=__webpack_require__("./node_modules/react/index.js"),prop_types=__webpack_require__("./node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),i18n=__webpack_require__("./ui/contexts/i18n.js"),page_container_footer=__webpack_require__("./ui/components/ui/page-container/page-container-footer/index.js");function SwapsFooter({onCancel,hideCancel,onSubmit,submitText,disabled,showTermsOfService,showTopBorder,className="",cancelText}){const t=(0,react.useContext)(i18n.OO);return react.createElement("div",{className:"swaps-footer"},react.createElement("div",{className:classnames_default()("swaps-footer__buttons",className,{"swaps-footer__buttons--border":showTopBorder})},react.createElement(page_container_footer.Z,{onCancel,hideCancel,cancelText:cancelText||t("back"),onSubmit,submitText,footerClassName:classnames_default()("swaps-footer__custom-page-container-footer-class",className),footerButtonClassName:classnames_default()("swaps-footer__custom-page-container-footer-button-class",{"swaps-footer__custom-page-container-footer-button-class--single":hideCancel}),disabled})),showTermsOfService&&react.createElement("div",{className:"swaps-footer__bottom-text",onClick:()=>__webpack_require__.g.platform.openTab({url:"https://metamask.io/terms.html"})},t("termsOfService")))}SwapsFooter.propTypes={onCancel:prop_types_default().func,hideCancel:prop_types_default().bool,onSubmit:prop_types_default().func,submitText:prop_types_default().string,disabled:prop_types_default().bool,showTermsOfService:prop_types_default().bool,showTopBorder:prop_types_default().bool,className:prop_types_default().string,cancelText:prop_types_default().string},SwapsFooter.__docgenInfo={description:"",methods:[],displayName:"SwapsFooter",props:{className:{defaultValue:{value:"''",computed:!1},description:"",type:{name:"string"},required:!1},onCancel:{description:"",type:{name:"func"},required:!1},hideCancel:{description:"",type:{name:"bool"},required:!1},onSubmit:{description:"",type:{name:"func"},required:!1},submitText:{description:"",type:{name:"string"},required:!1},disabled:{description:"",type:{name:"bool"},required:!1},showTermsOfService:{description:"",type:{name:"bool"},required:!1},showTopBorder:{description:"",type:{name:"bool"},required:!1},cancelText:{description:"",type:{name:"string"},required:!1}}}}}]);