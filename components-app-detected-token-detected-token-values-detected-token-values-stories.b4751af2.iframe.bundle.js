"use strict";(globalThis.webpackChunkmetamask_crx=globalThis.webpackChunkmetamask_crx||[]).push([[2518],{"./ui/components/app/detected-token/detected-token-values/detected-token-values.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DefaultStory:()=>DefaultStory,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _DefaultStory$paramet,_DefaultStory$paramet2,_DefaultStory$paramet3,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_detected_token_values__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ui/components/app/detected-token/detected-token-values/detected-token-values.js");const __WEBPACK_DEFAULT_EXPORT__={title:"Components/App/DetectedToken/DetectedTokenValues",argTypes:{token:{control:"object"},handleTokenSelection:{control:"func"},tokensListDetected:{control:"array"}},args:{token:{address:"0xc011a73ee8576fb46f5e1c5751ca3b9fe0af2a6f",symbol:"SNX",decimals:18,iconUrl:"https://assets.coingecko.com/coins/images/3406/large/SNX.png",aggregators:["aave","bancor","cmc","cryptocom","coinGecko","oneInch","paraswap","pmm","synthetix","zapper","zerion","zeroEx"]},tokensListDetected:{"0xc011a73ee8576fb46f5e1c5751ca3b9fe0af2a6f":{token:{name:"Synthetix Network",address:"0xc011a73ee8576fb46f5e1c5751ca3b9fe0af2a6f",symbol:"SNX",decimals:18,iconUrl:"https://assets.coingecko.com/coins/images/3406/large/SNX.png",aggregators:["aave","bancor","cmc","cryptocom","coinGecko","oneInch","paraswap","pmm","synthetix","zapper","zerion","zeroEx"]},selected:!0},"0x514910771af9ca656af840dff83e8264ecf986ca":{token:{name:"ChainLink Token",address:"0x514910771af9ca656af840dff83e8264ecf986ca",symbol:"LINK",decimals:18,iconUrl:"https://crypto.com/price/coin-data/icon/LINK/color_icon.png",aggregators:["coinGecko","oneInch","paraswap","zapper","zerion"]},selected:!0}}}},DefaultStory=(args=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(_detected_token_values__WEBPACK_IMPORTED_MODULE_1__.Z,args)).bind({});DefaultStory.storyName="Default",DefaultStory.parameters={...DefaultStory.parameters,docs:{...null===(_DefaultStory$paramet=DefaultStory.parameters)||void 0===_DefaultStory$paramet?void 0:_DefaultStory$paramet.docs,source:{originalSource:"args => {\n  return <DetectedTokenValues {...args} />;\n}",...null===(_DefaultStory$paramet2=DefaultStory.parameters)||void 0===_DefaultStory$paramet2||null===(_DefaultStory$paramet3=_DefaultStory$paramet2.docs)||void 0===_DefaultStory$paramet3?void 0:_DefaultStory$paramet3.source}}};const __namedExportsOrder=["DefaultStory"]},"./ui/components/app/detected-token/detected-token-values/detected-token-values.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_9__),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-redux/es/index.js"),_ui_box__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ui/components/ui/box/index.js"),_ui_check_box__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/components/ui/check-box/index.js"),_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ui/helpers/constants/design-system.ts"),_hooks_useTokenTracker__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ui/hooks/useTokenTracker.js"),_hooks_useTokenFiatAmount__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ui/hooks/useTokenFiatAmount.js"),_selectors__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ui/selectors/index.js"),_component_library__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./ui/components/component-library/index.js");const DetectedTokenValues=({token,handleTokenSelection,tokensListDetected})=>{var _tokensWithBalances$;const[tokenSelection,setTokenSelection]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)((()=>{var _tokensListDetected$t;return null===(_tokensListDetected$t=tokensListDetected[token.address])||void 0===_tokensListDetected$t?void 0:_tokensListDetected$t.selected})),{tokensWithBalances}=(0,_hooks_useTokenTracker__WEBPACK_IMPORTED_MODULE_5__.S)([token]),balanceString=null===(_tokensWithBalances$=tokensWithBalances[0])||void 0===_tokensWithBalances$?void 0:_tokensWithBalances$.string,formattedFiatBalance=(0,_hooks_useTokenFiatAmount__WEBPACK_IMPORTED_MODULE_6__.Q)(token.address,balanceString,token.symbol),useCurrencyRateCheck=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_7__.nsI);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{var _tokensListDetected$t2;setTokenSelection(null===(_tokensListDetected$t2=tokensListDetected[token.address])||void 0===_tokensListDetected$t2?void 0:_tokensListDetected$t2.selected)}),[tokensListDetected,token.address,tokenSelection,setTokenSelection]);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_box__WEBPACK_IMPORTED_MODULE_2__.ZP,{display:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_4__.bA.INLINE_FLEX,className:"detected-token-values"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_box__WEBPACK_IMPORTED_MODULE_2__.ZP,{marginBottom:1},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_component_library__WEBPACK_IMPORTED_MODULE_8__.xv,{variant:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_4__.rK.bodyLgMedium,as:"h4"},`${balanceString||"0"} ${token.symbol}`),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_component_library__WEBPACK_IMPORTED_MODULE_8__.xv,{variant:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_4__.rK.bodySm,as:"h6",color:_helpers_constants_design_system__WEBPACK_IMPORTED_MODULE_4__.d9.textAlternative},useCurrencyRateCheck?formattedFiatBalance||"$0":formattedFiatBalance)),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_box__WEBPACK_IMPORTED_MODULE_2__.ZP,{className:"detected-token-values__checkbox"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_check_box__WEBPACK_IMPORTED_MODULE_3__.ZP,{checked:tokenSelection,onClick:()=>{setTokenSelection(!tokenSelection),handleTokenSelection(token)}})))};DetectedTokenValues.propTypes={token:prop_types__WEBPACK_IMPORTED_MODULE_9___default().shape({address:prop_types__WEBPACK_IMPORTED_MODULE_9___default().string.isRequired,decimals:prop_types__WEBPACK_IMPORTED_MODULE_9___default().number,symbol:prop_types__WEBPACK_IMPORTED_MODULE_9___default().string,iconUrl:prop_types__WEBPACK_IMPORTED_MODULE_9___default().string,aggregators:prop_types__WEBPACK_IMPORTED_MODULE_9___default().array}),handleTokenSelection:prop_types__WEBPACK_IMPORTED_MODULE_9___default().func.isRequired,tokensListDetected:prop_types__WEBPACK_IMPORTED_MODULE_9___default().object},DetectedTokenValues.__docgenInfo={description:"",methods:[],displayName:"DetectedTokenValues",props:{token:{description:"",type:{name:"shape",value:{address:{name:"string",required:!0},decimals:{name:"number",required:!1},symbol:{name:"string",required:!1},iconUrl:{name:"string",required:!1},aggregators:{name:"array",required:!1}}},required:!1},handleTokenSelection:{description:"",type:{name:"func"},required:!0},tokensListDetected:{description:"",type:{name:"object"},required:!1}}};const __WEBPACK_DEFAULT_EXPORT__=DetectedTokenValues},"./ui/components/ui/check-box/check-box.component.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Km:()=>INDETERMINATE,ZP:()=>__WEBPACK_DEFAULT_EXPORT__,ri:()=>CHECKED,wT:()=>UNCHECKED});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__);const CHECKBOX_STATE={CHECKED:"CHECKED",INDETERMINATE:"INDETERMINATE",UNCHECKED:"UNCHECKED"},{CHECKED,INDETERMINATE,UNCHECKED}=CHECKBOX_STATE,CheckBox=({className,disabled,id,onClick,checked,title,dataTestId})=>{"boolean"==typeof checked&&(checked=checked?CHECKBOX_STATE.CHECKED:CHECKBOX_STATE.UNCHECKED);const ref=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)((()=>{ref.current.indeterminate=checked===CHECKBOX_STATE.INDETERMINATE}),[checked]),react__WEBPACK_IMPORTED_MODULE_0__.createElement("input",{checked:checked===CHECKBOX_STATE.CHECKED,className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("check-box",className,{"far fa-square":checked===CHECKBOX_STATE.UNCHECKED,"fa fa-check-square check-box__checked":checked===CHECKBOX_STATE.CHECKED,"fa fa-minus-square check-box__indeterminate":checked===CHECKBOX_STATE.INDETERMINATE}),disabled,id,onClick:onClick?event=>{event.preventDefault(),onClick()}:null,readOnly:!0,ref,title,"data-testid":dataTestId,type:"checkbox"})};CheckBox.propTypes={className:prop_types__WEBPACK_IMPORTED_MODULE_2___default().string,disabled:prop_types__WEBPACK_IMPORTED_MODULE_2___default().bool,id:prop_types__WEBPACK_IMPORTED_MODULE_2___default().string,onClick:prop_types__WEBPACK_IMPORTED_MODULE_2___default().func,checked:prop_types__WEBPACK_IMPORTED_MODULE_2___default().oneOf([...Object.keys(CHECKBOX_STATE),!0,!1]).isRequired,title:prop_types__WEBPACK_IMPORTED_MODULE_2___default().string,dataTestId:prop_types__WEBPACK_IMPORTED_MODULE_2___default().string},CheckBox.defaultProps={className:void 0,disabled:!1,id:void 0},CheckBox.__docgenInfo={description:"",methods:[],displayName:"CheckBox",props:{className:{defaultValue:{value:"undefined",computed:!0},description:"Add custom classname css",type:{name:"string"},required:!1},disabled:{defaultValue:{value:"false",computed:!1},description:"Check if checkbox disabled or not",type:{name:"bool"},required:!1},id:{defaultValue:{value:"undefined",computed:!0},description:"Checkbox ID",type:{name:"string"},required:!1},onClick:{description:"Click handler",type:{name:"func"},required:!1},checked:{description:"Check if the checkbox are checked or not",type:{name:"enum",value:[{value:"...Object.keys(CHECKBOX_STATE)",computed:!0},{value:"true",computed:!1},{value:"false",computed:!1}]},required:!0},title:{description:"Show title",type:{name:"string"},required:!1},dataTestId:{description:"Data test ID for checkbox Component",type:{name:"string"},required:!1}}};const __WEBPACK_DEFAULT_EXPORT__=CheckBox},"./ui/components/ui/check-box/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Km:()=>_check_box_component__WEBPACK_IMPORTED_MODULE_0__.Km,ZP:()=>_check_box_component__WEBPACK_IMPORTED_MODULE_0__.ZP,ri:()=>_check_box_component__WEBPACK_IMPORTED_MODULE_0__.ri,wT:()=>_check_box_component__WEBPACK_IMPORTED_MODULE_0__.wT});var _check_box_component__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ui/components/ui/check-box/check-box.component.js")},"./ui/hooks/useEqualityCheck.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>useEqualityCheck});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),lodash__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash/lodash.js");function useEqualityCheck(value,equalityFn=lodash__WEBPACK_IMPORTED_MODULE_1__.isEqual){const[computedValue,setComputedValue]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(value);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)((()=>{equalityFn(value,computedValue)||setComputedValue(value)}),[value,equalityFn,computedValue]),computedValue}},"./ui/hooks/useTokenFiatAmount.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>useTokenFiatAmount});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-redux/es/index.js"),_selectors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ui/selectors/index.js"),_helpers_utils_token_util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/helpers/utils/token-util.js"),_ducks_metamask_metamask__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ui/ducks/metamask/metamask.js"),_shared_modules_string_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./shared/modules/string-utils.ts");function useTokenFiatAmount(tokenAddress,tokenAmount,tokenSymbol,overrides={},hideCurrencySymbol){const contractExchangeRates=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_2__.fPF,react_redux__WEBPACK_IMPORTED_MODULE_1__.wU),conversionRate=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_ducks_metamask_metamask__WEBPACK_IMPORTED_MODULE_4__.PC),currentCurrency=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_2__.TV3),userPrefersShownFiat=(0,react_redux__WEBPACK_IMPORTED_MODULE_1__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_2__.i8I),showFiat=overrides.showFiat??userPrefersShownFiat,contractExchangeTokenKey=Object.keys(contractExchangeRates).find((key=>(0,_shared_modules_string_utils__WEBPACK_IMPORTED_MODULE_5__.J)(key,tokenAddress))),tokenExchangeRate=overrides.exchangeRate??(contractExchangeTokenKey&&contractExchangeRates[contractExchangeTokenKey]),formattedFiat=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>(0,_helpers_utils_token_util__WEBPACK_IMPORTED_MODULE_3__.Hr)(tokenExchangeRate,conversionRate,currentCurrency,tokenAmount,tokenSymbol,!0,hideCurrencySymbol)),[tokenExchangeRate,conversionRate,currentCurrency,tokenAmount,tokenSymbol,hideCurrencySymbol]);if(showFiat&&currentCurrency.toUpperCase()!==tokenSymbol)return formattedFiat}},"./ui/hooks/useTokenTracker.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>useTokenTracker});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_metamask_eth_token_tracker__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@metamask/eth-token-tracker/dist/index.js"),_metamask_eth_token_tracker__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_metamask_eth_token_tracker__WEBPACK_IMPORTED_MODULE_1__),react_redux__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-redux/es/index.js"),_selectors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/selectors/index.js"),_shared_constants_time__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./shared/constants/time.ts"),_shared_modules_string_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./shared/modules/string-utils.ts"),_useEqualityCheck__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ui/hooks/useEqualityCheck.js");function useTokenTracker(tokens,includeFailedTokens=!1,hideZeroBalanceTokens=!1){const chainId=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_3__.BVZ),userAddress=(0,react_redux__WEBPACK_IMPORTED_MODULE_2__.v9)(_selectors__WEBPACK_IMPORTED_MODULE_3__.GJg,react_redux__WEBPACK_IMPORTED_MODULE_2__.wU),[loading,setLoading]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)((()=>(null==tokens?void 0:tokens.length)>=0)),[tokensWithBalances,setTokensWithBalances]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),[error,setError]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),tokenTracker=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),memoizedTokens=(0,_useEqualityCheck__WEBPACK_IMPORTED_MODULE_5__.F)(tokens),updateBalances=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((tokenWithBalances=>{const matchingTokensWithIsERC721Flag=(hideZeroBalanceTokens?tokenWithBalances.filter((token=>Number(token.balance)>0)):tokenWithBalances).map((token=>{const additionalTokenData=memoizedTokens.find((t=>(0,_shared_modules_string_utils__WEBPACK_IMPORTED_MODULE_6__.J)(t.address,token.address)));return{...token,isERC721:null==additionalTokenData?void 0:additionalTokenData.isERC721,image:null==additionalTokenData?void 0:additionalTokenData.image}}));setTokensWithBalances(matchingTokensWithIsERC721Flag),setLoading(!1),setError(null)}),[hideZeroBalanceTokens,memoizedTokens]),showError=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((err=>{setError(err),setLoading(!1)}),[]),teardownTracker=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((()=>{tokenTracker.current&&(tokenTracker.current.stop(),tokenTracker.current.removeAllListeners("update"),tokenTracker.current.removeAllListeners("error"),tokenTracker.current=null)}),[]),buildTracker=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(((address,tokenList)=>{teardownTracker(),tokenTracker.current=new(_metamask_eth_token_tracker__WEBPACK_IMPORTED_MODULE_1___default())({userAddress:address,provider:__webpack_require__.g.ethereumProvider,tokens:tokenList,includeFailedTokens,pollingInterval:8*_shared_constants_time__WEBPACK_IMPORTED_MODULE_4__.sh,balanceDecimals:5}),tokenTracker.current.on("update",updateBalances),tokenTracker.current.on("error",showError),tokenTracker.current.updateBalances()}),[updateBalances,includeFailedTokens,showError,teardownTracker]);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>teardownTracker),[teardownTracker]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{setLoading(!0),userAddress&&void 0!==chainId&&__webpack_require__.g.ethereumProvider?(0===memoizedTokens.length&&updateBalances([]),buildTracker(userAddress,memoizedTokens)):teardownTracker()}),[userAddress,teardownTracker,chainId,memoizedTokens,updateBalances,buildTracker]),{loading,tokensWithBalances,error}}}}]);